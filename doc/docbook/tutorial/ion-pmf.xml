<chapter id="ion-pmf-scet"> <title>Ion-ion desolvation</title>
  <para>
    This example demonstrates the effects of "desolvation" as modeled by
    reaction field terms in an implicit solvent setting.  It illustrates that,
    while like charges do attract, the elimination of high dielectric material
    to form the charge-charge interface can introduce a substantial energetic
    barrier to association.
  </para>

  <para>
    The scripts required to run this example are bundled in the tarball
    available for download 
    <ulink url="examples/ion-pmf/ion-pmf.tar.gz">here</ulink>.
    This tarball should be uncompressed via:
    <screen>
      <prompt>$</prompt> <userinput>gzip -dc ion-pmf.tar.gz | tar xvf -</userinput>
    </screen>
    The main program is the file <filename>runme.sh</filename> which runs APBS
    repeatedly on the following input file:
    <example> <title>APBS input for ion-ion PMF</title>
      <programlisting>
read 
    mol pqr complex.pqr    # Two-ion complex
    mol pqr mol1.pqr       # Ion 1
    mol pqr mol2.pqr       # Ion 2
end
elec name comp_solv        # Solvated complex
    mg-manual
    dime 97 33 33          # Grid dimensions
    nlev 4                 # Multigrid levels
    glen 24 12 12          # Grid lengths
    gcent 6 0 0            # Grid center on (6.0, 0.0, 0.0)
    mol 1 
    lpbe                   # Linearized PB
    bcfl mdh               # Full multipole boundary condition
    ion 1 0.000 2.0        # Zero ionic strength
    ion -1 0.000 2.0       # Zero ionic strength
    pdie 1.0               # Solute dielectric
    sdie 78.54             # Solvent dielectric
    chgm spl2              # Cubic spline charge discretization
    srfm mol               # Molecular surface
    srad 1.4               # Solvent probe radius
    swin 0.3               # Surface spline window
    temp 298.15            # Temperature
    gamma 0.00072          # Apolar coefficient
    write pot dx pot-solv  # Inhomogeneous dielectric potential
    calcenergy total       # Total energy
    calcforce no           # No forces
end
elec name comp_vac
    mg-manual
    dime 97 33 33
    nlev 4 
    glen 24 12 12 
    gcent 6 0 0 
    mol 1
    lpbe
    bcfl mdh
    ion 1 0.000 2.0
    ion -1 0.000 2.0
    pdie 1.0
    sdie 1.0
    chgm spl2
    srfm mol
    srad 1.4
    swin 0.3
    temp 298.15
    gamma 0.00072
    calcenergy total
    calcforce no
    write pot dx pot-vac
end
elec name ion1_solv
    mg-manual
    dime 97 33 33
    nlev 4 
    glen 24 12 12 
    gcent 6 0 0 
    mol 2
    lpbe
    bcfl mdh
    ion 1 0.000 2.0
    ion -1 0.000 2.0
    pdie 1.0
    sdie 78.54
    chgm spl2
    srfm mol
    srad 1.4
    swin 0.3
    temp 298.15
    gamma 0.00072
    calcenergy total
    calcforce no
end
elec name ion1_vac
    mg-manual
    dime 97 33 33
    nlev 4 
    glen 24 12 12 
    gcent 6 0 0 
    mol 2
    lpbe
    bcfl mdh
    ion 1 0.000 2.0
    ion -1 0.000 2.0
    pdie 1.0
    sdie 1.0
    chgm spl2
    srfm mol
    srad 1.4
    swin 0.3
    temp 298.15
    gamma 0.00072
    calcenergy total
    calcforce no
end
elec name ion2_solv
    mg-manual
    dime 97 33 33
    nlev 4 
    glen 24 12 12 
    gcent 6 0 0 
    mol 3
    lpbe
    bcfl mdh
    ion 1 0.000 2.0
    ion -1 0.000 2.0
    pdie 1.0
    sdie 78.54
    chgm spl2
    srfm mol
    srad 1.4
    swin 0.3
    temp 298.15
    gamma 0.00072
    calcenergy total
    calcforce no
end
elec name ion2_vac
    mg-manual
    dime 97 33 33
    nlev 4 
    glen 24 12 12 
    gcent 6 0 0 
    mol 3
    lpbe
    bcfl mdh
    ion 1 0.000 2.0
    ion -1 0.000 2.0
    pdie 1.0
    sdie 1.0
    chgm spl2
    srfm mol
    srad 1.4
    swin 0.3
    temp 298.15
    gamma 0.00072
    calcenergy total
    calcforce no
end

print energy comp_solv - comp_vac - ion1_solv + ion1_vac - ion2_solv + ion2_vac end

quit
      </programlisting>
    </example>
    This rather complicated input script calculates the solvation energy for
    each of the components (the ion-ion complex and each of the isolated ions)
    and then computes the change in solvation energy upon binding.
  </para>
  <para>
    The series of APBS calculations can be started by typing:
    <screen>
      <prompt>$</prompt> <userinput>bash runme.sh</userinput>
    </screen>
    The script will then perform the APBS calculations and plot the energies
    of interaction as a function of distance.  Gnuplot should plot 
    <itemizedlist>
      <listitem>
        <para>the energy of interaction,</para>
      </listitem>
      <listitem>
        <para>the Coulomb energy for the homogeneous system (solvent
          dielectric),</para>
      </listitem>
      <listitem>
        <para>
          and the relative positions of the ions with respect to a
          solvent-sized probe.  
        </para>
      </listitem>
    </itemizedlist>
    Note that the energy increases with respect to the homogeneous system when
    the two ions are within a solvent-probe diameter of each other.  This is a
    desolvation penalty that models the <emphasis>polar</emphasis> energy of
    removing water from the solute-solute interface.
  </para>
  <para>
    This script also calculates the reaction field potential (the potential
    for the fully-solvated system minus the potential for the vacuum system)
    along the x-axis.  These potentials can be visualized via Gnuplot by
    typing:
    <screen>
      <prompt>$</prompt> <userinput>gnuplot -persist rxnfield.gnuplot</userinput>
    </screen>
    and are shown below:
    <figure> <title>Reaction fields for ion-ion PMF</title>
      <graphic fileref="images/rxnfld.png"></graphic>
    </figure>
    Notice that the reaction field is positive to the right of the positive
    moving charge and is negative to the left of the fixed negative charge.
    This demonstrates a change in screening behavior in the inhomogeneous
    dielectric medium with respect to the vacuum.   In particular, for the
    solvated system, the electrostatic potential is more positive next to the
    positive ion and more negative next to the negative ion, than for the
    vacuum system.
  </para>

</chapter>
