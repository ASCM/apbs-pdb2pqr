<chapter id="condensation-sect"> <title>NaCl condensation around DNA</title>
  <para>
    Ion condensation to DNA is an excellent example of non-specific
    interactions of cations with polyelectrolytes.  In this example we
    demonstrate NaCl condensation to a B-DNA dodecamer.
  </para>

  <sect1> <title>PQR file</title>
    <para>
      The starting structure was a 35 base-pair DNA molecule
        with a net charge of -70 e.  The PQR file for this system
      is available for download 
      <ulink url="examples/condensation/dna.pqr">here</ulink> and shown in the
      following figure:
      <figure> <title>B-DNA dodecamer</title>
        <graphic fileref="images/dna.png"></graphic>
      </figure>
    </para>
  </sect1>

  <sect1> <title>Calculating the potential and charge density</title>
    <para>  The goal of the following APBS calculation is to generate
      visualization-quality solutions to the nonlinear PBE equation and to
      write out the electrostatic potential and charge density for subsequent
      analysis.  This procedure is carried out in the following APBS input
      file, available for download 
      <ulink url="examples/condensation/apbs.in">here</ulink>.
      <example> <title>APBS DNA condensation input file</title>
        <programlisting>
read 
    mol pqr dna.pqr         # Read in DNA
end
elec
    mg-auto
    dime 97 97 161          # Rectangular grid dimensions
    cglen 160 160 230       # Rectangular box
    fglen 130 130 200       # Rectangular box
    cgcent mol 1            # Center on the molecule
    fgcent mol 1            # Center on the molecule
    mol 1                   
    npbe                    # Nonlinear DNA
    bcfl mdh                # Full multipole approximation
    ion 1 0.100 2.0         # 100 mM Na+
    ion -1 0.100 2.0        # 100 mM Cl-
    pdie 1.0                # Solute dielectric
    sdie 78.54              # Solvent dielectric
    chgm spl0               # Linear charge discretization
    srfm smol               # Smoothed molecular surface
    srad 1.4                # Solvent probe radius
    swin 0.3                # Spline surface window (not used)
    sdens 10.0              # Sphere density
    temp 298.15             # Temperature
    gamma 0.105             # Apolar coefficient
    calcenergy no           # No energies
    calcforce no            # No forces
    write qdens dx qdens    # Write out charge density
    write pot dx pot        # Write out potential
end

quit
        </programlisting>
      </example>
      In this example, the full multipole boundary condition was used to
      better represent the enlongated charge distribution of the DNA.
      As usual, this file can then be used with APBS via the command:
      <screen>
        <prompt>$</prompt> <userinput>apbs <replaceable>apbs.in</replaceable></userinput>
      </screen>
      where <replaceable>apbs.in</replaceable> is the name of the downloaded
      input file.  This example took roughly 4 minutes on a 2.2 GHz Intel
      Pentium 4.
    </para>
  </sect1>

  <sect1> <title>Visualization</title>
    <para>
      <important>
        <para> 
          The following requires the VMD functions provided in the 
          <ulink url="examples/condensation/my_functions">my_functions</ulink>
          Tcl script.  Please download this before proceeding.
        </para>
      </important>
    </para>

    <sect2> <title> Electrostatic potential </title>
      <para> The electrostatic potential can be visualized via VMD by running
        the <ulink url="examples/condensation/pot.vmd">pot.vmd</ulink> script
        in VMD:
        <screen>
          <prompt>$</prompt> <userinput>vmd -e pot.vmd</userinput>
        </screen>
        The result should be the rather uninteresting potential isosurface:
        <figure> <title>DNA electrostatic potential</title>
          <graphic fileref="images/dna-pot.png"></graphic>
        </figure>
        which can be adjusted via the 
        <menuchoice>
          <guimenu>Graphics</guimenu>
          <guimenuitem>Representations</guimenuitem>
        </menuchoice>
        menu item.
      </para>
    </sect2>

    <sect2> <title>Charge density</title>
      <para> The charge density for the DNA is much more interesting than the
        electrostatic potential.  The first step in our analysis will be to
        plot the average radial density around the DNA using the Python script
        <ulink url="examples/condensation/density">density</ulink>.
        This script can then be used to process the volume-based density file
        <filename>qdens.dx</filename> produced by our earlier APBS run:
        <screen>
          <prompt>$</prompt> <userinput>python density qdens.dx | tee qdens.dat</userinput>
        </screen>
        The result of this command will be 3 columns of data (on the screen
        and written to <filename>qdens.dat</filename>):  the radius (in
        A), the charge density at the given radius averaged over all
        angles and displacements along the center of the cylinder (+/- 10
        A)
        (in e<subscript>c</subscript> A<superscript>-3</superscript>), 
        and the cumulative charge density per unit distance along the DNA
        molecule
        (in e<subscript>c</subscript> A<superscript>-2</superscript>).
        This averaging is performed over the center of the DNA cylinder to
        avoid well-known "end effects".
      </para>
      <para>
        The overall charge density profile can be visualized by starting 
        Gnuplot:
        <screen>
          <prompt>$</prompt> <userinput>gnuplot</userinput>
        </screen>
        and typing the following commands within Gnuplot:
        <screen>
          <prompt>gnuplot&gt;</prompt> <userinput>set xlabel "Radius (A)"</userinput>
          <prompt>gnuplot&gt;</prompt> <userinput>set ylabel "Charge density (e/A^3)"</userinput>
          <prompt>gnuplot&gt;</prompt> <userinput>plot 'qdens.dat' using 1:2 title 'Charge density' with linespoints</userinput>
        </screen>
        The resulting plot shows the distribution of ions around the DNA
        molecule.  The cumulative charge density can also be plotted by:
        <screen>
          <prompt>gnuplot&gt;</prompt> <userinput>set ylabel "Cumulative charge density per length (e/A^2)"</userinput>
          <prompt>gnuplot&gt;</prompt> <userinput>plot 'qdens.dat' using 1:3 title 'Charge density' with linespoints</userinput>
        </screen>
        When you are done with Gnuplot, simply exit by typing
        <userinput>quit</userinput> at the prompt.
        The results of these calculations are very sensitive to grid spacing
        and boundary conditions; this is mainly why the PB solution appears to
        be over-screening the DNA molecule.
      </para>
      <para>
        The charge distribution can also be visualized with VMD by downloading
        <ulink url="examples/condensation/qdens.vmd">qdens.vmd</ulink> and
        running:
        <screen>
          <prompt>$</prompt> <userinput>vmd -e qdens.vmd</userinput>
        </screen>
      </para>
      <para>
        You can translate the DNA molecule towards you by clicking in the VMD
        OpenGL window and typing 't' and holding down the middle mouse button
        while dragging.  By doing this, you can cut through the charge density
        isosurfaces and get a better look at how the salt is arranged around the
        DNA.  Additionally, you can modify the isocontour values 
        (<menuchoice> <guimenu>Graphics</guimenu>
          <guimenuitem>Representations</guimenuitem> </menuchoice> menu item)
        to examine regions of different salt concetration.  The result of all
        this manipulation should look something like the following image:
        <figure> <title>NaCl charge density around DNA</title>
          <graphic fileref="images/dna-qdens.png"></graphic>
        </figure>
      </para>
    </sect2>
  </sect1>
</chapter>
