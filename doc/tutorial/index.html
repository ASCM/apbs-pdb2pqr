<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>APBS tutorial</title><meta name="generator" content="DocBook XSL Stylesheets V1.70.1" /></head><body><div class="book" lang="en" xml:lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="id826569"></a>APBS tutorial</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Nathan</span> <span class="surname">Baker</span></h3><div class="affiliation"><span class="orgname">Washington University in St.  Louis<br /></span><span class="orgdiv">Department of Biochemistry and
					Molecular Biophysics<br /></span><span class="orgdiv">Center for Computational Biology<br /></span></div></div></div><div><p class="copyright">Copyright © 2002, 2003, 2004, 2005, 2006 Washington University in St.  Louis</p></div><div><div class="legalnotice"><a id="id903218"></a><p>This file is part of APBS.</p><p>This program is free software; you can
				redistribute it and/or modify it under the
				terms of the GNU General Public License as
				published by the Free Software Foundation;
				either version 2 of the License, or (at your
				option) any later version.</p><p>This
				program is distributed in the hope that it will
				be useful, but WITHOUT ANY WARRANTY; without
				even the implied warranty of MERCHANTABILITY or
				FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
				General Public License for more details.</p><p>You should have received a copy of the GNU
				General Public License along with this program;
				if not, write to the Free Software Foundation,
				Inc., 59 Temple Place, Suite 330, Boston, MA
				02111-1307 USA</p><p>Linking APBS statically or dynamically with other
				modules is making a combined work based on
				APBS.  Thus, the terms and conditions of the
				GNU General Public License cover the whole
				combination.</p><p>SPECIAL GPL EXCEPTION: In addition, as a special
				exception, the copyright holders of APBS give
				you permission to combine the APBS program with
				free software programs and libraries that are
				released under the GNU LGPL or with code
				included in releases of ISIM, Ion Simulator
				Interface, PMV, PyMOL SMOL, VMD, and Vision.
				Such combined software may be linked with APBS
				and redistributed together in original or
				modified form as mere aggregation without
				requirement that the entire work be under the
				scope of the GNU General Public License.  This
				special exception permission is also extended
				to any software listed in the SPECIAL GPL
				EXCEPTION clauses by the PMG, FEtk, MC, or
				MALOC libraries.</p><p>Note that people who make modified versions of
				APBS are not obligated to grant this special
				exception for their modified versions; it is
				their choice whether to do so.  The GNU General
				Public License gives permission to release a
				modified version without this exception; this
				exception also makes it possible to release a
				modified version which carries forward this
				exception.</p></div></div></div><hr /></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#introduction-sect">1. How to read this tutorial</a></span></dt><dt><span class="chapter"><a href="#pdb2pqr-sect">2. How do I get my structure ready for
			electrostatics calculations?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#pqr-format-sect">2.1. PQR format</a></span></dt><dt><span class="sect1"><a href="#xml-format-sect">2.2. XML format</a></span></dt><dt><span class="sect1"><a href="#pdb2pqr-subsect">2.3. Generating PQR files from PDB
				files (PDB2PQR)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#viz-sect">3. How do I visualize the electrostatic
potential around my biomolecule?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#vmd-sect">3.1. VMD</a></span></dt><dt><span class="sect1"><a href="#pymol-sect">3.2. PyMOL</a></span></dt><dt><span class="sect1"><a href="#pmv-sect">3.3. PMV</a></span></dt></dl></dd><dt><span class="chapter"><a href="#solvation-sect">4. How do I calculate a solvation
energy?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#id904897">4.1. Polar solvation</a></span></dt><dt><span class="sect1"><a href="#id904909">4.2. Apolar solvation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#binding-sect">5. How do I calculate a binding
energy?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#id904936">5.1. Hey! You don't have any parameters for my
ligand!</a></span></dt><dt><span class="sect1"><a href="#id904948">5.2. Polar contributions</a></span></dt><dt><span class="sect1"><a href="#id904960">5.3. Apolar contributions</a></span></dt></dl></dd><dt><span class="chapter"><a href="#forces-sect">6. How do I calculate solvation
forces?</a></span></dt><dd><dl><dt><span class="sect1"><a href="#id904987">6.1. Polar solvation</a></span></dt><dt><span class="sect1"><a href="#id904998">6.2. Apolar solvation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#pka-sect">7. How do I calculate a pK<sub>a</sub>?</a></span></dt><dt><span class="chapter"><a href="#parallel-sect">8. My calculation requires too much memory!</a></span></dt><dt><span class="chapter"><a href="#simulation-sect">9. How do I use APBS with my
molecular dynamics program (for MM/PBSA, etc.)?</a></span></dt><dt><span class="chapter"><a href="#gemstone-sect">10. Can I run APBS via the web?  (Gemstone) </a></span></dt><dd><dl><dt><span class="sect1"><a href="#id905094">10.1. Getting Gemstone</a></span></dt><dt><span class="sect1"><a href="#id905119">10.2. Preparing a structure with PDB2PQR</a></span></dt><dt><span class="sect1"><a href="#id905231">10.3. Perform an electrostatics calculation with APBS</a></span></dt></dl></dd><dt><span class="chapter"><a href="#more-sect">11. More examples...</a></span></dt><dt><span class="chapter"><a href="#help-sect">12. None of this answered my question...</a></span></dt></dl></div><div class="list-of-figures"><p><b>List of Figures</b></p><dl><dt>3.1. <a href="#id904218">Arc repressor isocontours in VMD</a></dt><dt>3.2. <a href="#id904389">Arc repressor surface potential in VMD</a></dt><dt>3.3. <a href="#id904744">+/- 1 kT/e
							electrostatic potential
							isocontours of FAS2 in PyMOL</a></dt><dt>3.4. <a href="#id904849">+/- 5 kT/e
							electrostatic surface potential
							of FAS2 in PyMOL</a></dt><dt>10.1. <a href="#id905201">Gemstone PDB2PQR calculation</a></dt><dt>10.2. <a href="#id905290">Gemstone APBS/Calculation screen</a></dt><dt>10.3. <a href="#id905339">Gemstone APBS/Grid screen</a></dt><dt>10.4. <a href="#id905373">Gemstone APBS/Physics screen</a></dt><dt>10.5. <a href="#id905408">Gemstone APBS/File I/O screen</a></dt><dt>10.6. <a href="#id905435">Gemstone APBS/Calculation screen (run complete)</a></dt></dl></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="introduction-sect"></a>Chapter 1. How to read this tutorial</h2></div></div></div><p>This tutorial is designed as a "how to" document to get
			users acquainted with computational electrostatics
			calculations using APBS.  In order to perform the
			provided examples, you will need the latest version of
			APBS (<a href="http://apbs.sf.net" target="_top">http://apbs.sf.net</a>).  Other
			requirements are listed in the individual
			sections.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png" /></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Note that many of the examples in this tutorial
				can also be run through the web-based <a href="http://gemstone.mozdev.org/" target="_top">Gemstone</a>
				service without the need for local
				installations of the APBS software.  More
				information is available in <a href="#gemstone-sect" title="Chapter 10. Can I run APBS via the web?  (Gemstone) ">Chapter 10, <i>Can I run APBS via the web?  (Gemstone) </i></a>.
			</p></td></tr></table></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="pdb2pqr-sect"></a>Chapter 2. How do I get my structure ready for
			electrostatics calculations?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#pqr-format-sect">2.1. PQR format</a></span></dt><dt><span class="sect1"><a href="#xml-format-sect">2.2. XML format</a></span></dt><dt><span class="sect1"><a href="#pdb2pqr-subsect">2.3. Generating PQR files from PDB
				files (PDB2PQR)</a></span></dt></dl></div><p>
			In order to perform electrostatics calculations on your
			biomolecular structure of interest, you need to provide
			atomic charge and radius information to APBS.  Charges
			are used to form the biomolecular charge distribution
			for the Poisson-Boltzmann (PB) equation while the radii
			are used to construct the dielectric and ionic
			accessibility functions.  This charge and radius
			information can be provided to APBS in a few different
			formats which are described in more detail below.
		</p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pqr-format-sect"></a>2.1. PQR format</h2></div></div></div><p>
				The <a href="../user-guide/index.html#pqr-format" target="_top">PQR
					format</a> provides a very simple
				way to include parameter information by 
				by replacing the occupancy and temperature
				columns of a PDB-format structure file with 
				charge ("Q") and radius ("R") information.
				Unfortunately, the simplicity of this format
				also limits its extensibility:  it can be very
				difficult to add new atom types and parameters
				in a generic format without the use of external
				software such as <a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a>.
				The XML parameter format described <a href="#xml-format-sect" title="2.2. XML format">below</a>
				is much easier to modify.
			</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="xml-format-sect"></a>2.2. XML format</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pdb2pqr-subsect"></a>2.3. Generating PQR files from PDB
				files (PDB2PQR)</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial was prepared using PDB2PQR
					1.1.2</p></td></tr></table></div><p>
				The <a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a>
				web service and software will convert
				most PDB files into PQR format with
				some caveats:
				</p><div class="itemizedlist"><ul type="disc"><li><p>
							Limited ligand support.
							Given the ambiguities
							associated with
							implicit solvent force
							field parameter
							development, atom types
							not included in
							standard force fields
							are currently not
							supported by PDB2PQR.
							We're in the process of
							including such support.
						</p></li><li><p>
							Inability to "repair"
							large regions of
							missing coordinates.
							Although PDB2PQR can
							fix some missing heavy
							atoms in sidechains, it
							does not currently have
							the (nontrivial)
							capability to model in
							large regions of
							missing backbone and
							sidechain coordinates.
						</p></li></ul></div><p>
				<a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a> will
				also perform hydrogen bond optimization,
				sidechain rotamer search, limited titration
				state assignment, and APBS input file
				preparation.  Please see 
				<a href="http://pdb2pqr.sf.net/" target="_top">http://pdb2pqr.sf.net/</a>
				for more details.
			</p><p>
				As mentioned above, PDB2PQR is discussed in
				more detailed on the 
				<a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR
					homepage</a> .  Therefore, we will
				review the minimal steps required to produce a
				PQR file from a PDB file here.  To begin,
				choose a server from <a href="http://pdb2pqr.sf.net/#availability" target="_top">http://pdb2pqr.sf.net/#availability</a>.
			</p><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id903494"></a>2.3.1. Choose the PDB file to convert</h3></div></div></div><p>
					Either enter the 4-character <a href="http://www.pdb.org/" target="_top">PDB</a>
					ID or accession number (e.g., <a href="http://www.pdb.org/pdb/explore.do?structureId=1FAS" target="_top">1FAS</a>,
					<a href="http://www.pdb.org/pdb/explore.do?structureId=1MAH" target="_top">1MAH</a>,
					<a href="http://www.pdb.org/pdb/explore.do?structureId=1LYS" target="_top">1LYS</a>,
					etc.) or upload your own PDB file.
					</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p> Note that, if you choose
							to enter a 4-character
							PDB file, PDB2PQR will
							process 
							<span class="emphasis"><em>all
								recognizable 
								chains</em></span> 
							of PDB file
							<span class="emphasis"><em>as it was
								deposited</em></span>
							in the PDB (e.g., not 
							the biological unit,
							any related
							transformations, etc.).
						</p></td></tr></table></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="pdb2pqr-ff-sect"></a>2.3.2. Pick a forcefield</h3></div></div></div><p>
					<span class="emphasis"><em>For most applications, the choice is
						easy:  PARSE.</em></span>  This
					forcefield has been optimized for
					implicit solvent calculation and is
					probably the best choice for
					visualization of protein electrostatics
					and many common types of energetic
					calculations for proteins.  However,
					AMBER and CHARMM may be more
					appropriate if you are attempting to
					compare directly to simulations
					performed with those force fields,
					require nucleic acid support, are
					simulating ligands parameterized with
					those force fields, etc.
				</p><p>
					It is also possible to upload a
					user-defined forcefield (e.g., to
					define radii and charges for ligands or
					unusual residues).  Please see the
					<a href="http://pdb2pqr.sf.net/" target="_top">PDB2PQR</a>
					documentation for more information.
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id903582"></a>2.3.3. Output naming scheme</h3></div></div></div><p>This is largely irrelevant to
					electrostatics calculations but may be
					important for visualization.  When in
					doubt, choose the "Internal naming
					scheme" which attempts to conform to
					IUPAC standards.</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id903596"></a>2.3.4. Other options</h3></div></div></div><p>These options fall into two categories:
					how to build missing atoms (including
					hydrogens) onto the structure and
					additional output configuration.</p><div class="variablelist"><p class="title"><b>Missing atom build
						options</b></p><dl><dt><span class="term"> Ensure that new atoms
							are not rebuilt too
							close to existing atoms
						</span></dt><dd><p>
								"Debump" any
								rebuilt atoms
								to remove
								steric clashes.
								<span class="emphasis"><em>This
									is
generally a good option to include</em></span>.
							</p></dd><dt><span class="term"> Optimize the hydrogen
							bonding network </span></dt><dd><p>
								This rotates
								hydrogen
								torsion angles
								and flips
								ambiguous
								sidechain
								placements in
								an attempt to
								optimize the
								overall
								hydrogen
								bonding
								network.
								<span class="emphasis"><em>This
									is
generally a good option to include</em></span>.
							</p></dd><dt><span class="term"> Use 
							<a href="http://propka.chem.uiowa.edu/" target="_top">PROPKA</a> 
							to assign protonation
							states at pH...</span></dt><dd><p> Assign titration
								states (for
								proteins) with
								<a href="http://propka.chem.uiowa.edu/" target="_top">PROPKA</a>.
							</p></dd></dl></div><div class="variablelist"><p class="title"><b>Output options</b></p><dl><dt><span class="term">Create an APBS input
							file</span></dt><dd><p> Useful if you're
								planing to run
								APBS on your
								own.  At the
								very least,
								this generates
								a nice
								template for
								customization.
							</p></dd><dt><span class="term">Add/keep chain IDs in the
							PQR file</span></dt><dd><p> Unfortunately,
								chain IDs still
								baffle
								APBS<sup>[<a id="id903720" href="#ftn.id903720">1</a>]</sup>
								but they can be
								useful for
								visualization.
							</p></dd></dl></div></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id903735"></a>2.3.5. Running the calculation and downloading
					the results</h3></div></div></div><p>Hit <span class="guibutton">Submit</span> to run
					the calculation.  Note that some
					options (particularly hydrogen bond
					network optimization and PROPKA
					assignment) can increase the runtime.
					You should get intermittent updates on
					the progress of your calculation from
					the web server.</p><p>When you download the result from the web
					page,<sup>[<a id="id903757" href="#ftn.id903757">2</a>]</sup>
					many browsers will attach a ".txt"
					extension to the file.  This generally
					needs to be removed before it can be
					used with visualization software.
				</p><p>Finally, for many types of electrostatic
					calculations, 
					<span class="emphasis"><em>it will be useful to remove
						any explicit water and
						unparameterized ligands from the 
						PQR structure</em></span> before
					proceeding.  This can be done with your
					favorite <a href="http://en.wikipedia.org/wiki/Text_editor" target="_top">text
						editor</a>.
				</p></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>STILL UNDER CONSTRUCTION</p></td></tr></table></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div class="footnote"><p><sup>[<a id="ftn.id903720" href="#id903720">1</a>] </sup>Sorry,
										we're
										still
										working
										on
										introducing
										this
										while
										maintaining
										flexibility
										for
										parsing
										strange
										PDB
										formats...</p></div><div class="footnote"><p><sup>[<a id="ftn.id903757" href="#id903757">2</a>] </sup>One can usually
							download, rather than
							display the file, by
							right-clicking or
							Ctrl-clicking the
							link.</p></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="viz-sect"></a>Chapter 3. How do I visualize the electrostatic
potential around my biomolecule?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#vmd-sect">3.1. VMD</a></span></dt><dt><span class="sect1"><a href="#pymol-sect">3.2. PyMOL</a></span></dt><dt><span class="sect1"><a href="#pmv-sect">3.3. PMV</a></span></dt></dl></div><p> There are a number of excellent molecular graphics
			programs which can be used to visualize electrostatic
			properties in the context of the biomolecule.  Since
			there are far too many to review in any depth, we will
			focus on the 3 packages with which we are most
			familiar. </p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="vmd-sect"></a>3.1. VMD</h2></div></div></div><p>
				The <a href="http://www.ks.uiuc.edu/Research/vmd/" target="_top">VMD</a> molecular
				graphics software package provides support for
				both the execution of APBS and the
				visualization of the resulting electrostatic
				potentials.  Documentation on the APBS
				interface has been provided by the VMD
				developers at <a href="http://www.ks.uiuc.edu/Research/vmd/plugins/apbsrun/" target="_top">http://www.ks.uiuc.edu/Research/vmd/plugins/apbsrun/</a>.
				We will supplement this with a basic
				demonstration of how go from a PDB entry to a
				plot of structure &amp; potential in VMD using
				APBS.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial was written using VMD
					1.8.5.</p></td></tr></table></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id903857"></a>3.1.1. Generating the PQR</h3></div></div></div><p> 
					We'll perform this example with arc
					repressor
					(PDB ID <a href="http://www.pdb.org/pdb/explore.do?structureId=1MYK" target="_top">1MYK</a>),
					a DNA binding protein.  The first step
					in the visualization process is
					generating a PQR file for use with VMD
					and APBS.  Please follow the directions
					in <a href="#pdb2pqr-subsect" title="2.3. Generating PQR files from PDB&#10;&#9;&#9;&#9;&#9;files (PDB2PQR)">Section 2.3, “Generating PQR files from PDB
				files (PDB2PQR)”</a> to
					generate a PQR file for this structure.
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id903882"></a>3.1.2. Loading the PQR</h3></div></div></div><p>
					Load the PQR file you just created into
					VMD (<span class="guimenu">File</span> → <span class="guimenuitem">New molecule...</span> in the VMD Main window).
					Adjust the molecule to the desired
					view.
					<sup>[<a id="id903909" href="#ftn.id903909">3</a>]</sup>
					Depending on the force
					field<sup>[<a id="id903921" href="#ftn.id903921">4</a>]</sup>
					you used in PDB2PQR, you may notice
					that VMD is displaying some strange
					bonds.  When a PQR file is loaded into
					VMD, bond distances are inferred from
					the PQR radii.  These radii were chosen
					for continuum electrostatics
					calculations, not visualization.  Don't
					worry if some of the bonds appear a bit
					strange (hide the hydrogens if it
					really bothers you).
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id903935"></a>3.1.3. Running the electrostatics calculation</h3></div></div></div><p>
					You're now ready for electrostatics
					calculations.  
					</p><div class="orderedlist"><ol type="1"><li><p>Choose
								<span class="guimenu">Extensions</span> → <span class="guisubmenu">Analysis</span> → <span class="guimenuitem">APBS
										electrostatics</span>
								in the VMD Main
								window.  A new
								APBS Tool
								window should
								appear.
							</p></li><li><p>Choose 
								<span class="guimenu">Edit</span> → <span class="guimenuitem">Settings...</span> 
								in the APBS
								Tool window and
								set the path to
								your local copy
								of the APBS
								executable.
								Hit
								<span class="guibutton">OK</span>
								to close this
								window.
							</p></li><li><p>Select the "0"
								calculation
								from the
								"<span class="guilabel">Individual
									PB
									calculations
									(ELEC):</span>"
								window.  Hit 
								the
								<span class="guibutton">Edit</span>
								button.  Adjust
								the APBS
								settings here
								as you desire.
								The defaults
								are usually
								fine, although
								it may be
								useful to edit
								the ions to
								adjust the
								ionic strength
								used in the
								calculation.
								Hit
								<span class="guibutton">OK</span>
								when you're
								done.
							</p></li><li><p>You're now ready
								to run the
								calculation.
								Hit
								<span class="guibutton">Run
									APBS</span>
								in the APBS
								Tool window.
								Check the VMD
								Console window
								for information
								about the job
								while it's
								running.  When
								the job is
								finished, a
								"APBSRun: Load
								APBS Maps"
								window should
								appear.  Select
								"<span class="guibutton">Load
									files
									into
									top
									molecule</span>"
								and hit
								<span class="guibutton">OK</span>.
							</p></li></ol></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id904081"></a>3.1.4. Electrostatics visualization</h3></div></div></div><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id904087"></a>3.1.4.1. Isocontour visualization</h4></div></div></div><p>
						One of the most popular
						visualization methods is the
						isocontour.
					</p><div class="orderedlist"><ol type="1"><li><p>First, choose <span class="guimenu">Graphics</span> → <span class="guimenuitem">Representations...</span>
								from the VMD
								Main window.
							</p></li><li><p>
								Hit the
								<span class="guibutton">Create
									Rep</span>
								button and
								change
								<span class="guilabel">Drawing
									Method</span>
								to
								"Isosurface".
							</p></li><li><p>
								Change
								<span class="guilabel">Draw</span>
								from "Points"
								to "Solid
								Surface" and
								<span class="guilabel">Material</span>
								to
								"Transparent". 
							</p></li><li><p>
								Note that the
								current
								isovalue is 0;
								change this to
								1 (or 5 or 10
								or whatever)
								depending on
								your personal
								preferences.
							</p></li><li><p>
								To continue the
								lonstanding
								tradition of
								electrostatic
								potential
								coloring,
								choose "ColorID
								0" for the
								<span class="guilabel">Coloring
									Method</span>.
							</p></li><li><p>
								For the
								negative
								isocontour, hit
								"<span class="guibutton">Create
									Rep</span>"
								and select the
								newly created
								representation.
								Change the
								isocontour
								value to -1 (or
								5 or 10...) and
								the ColorID to
								1.
							</p></li></ol></div><p>
						At this point, you probably
						have an image that looks
						something like this (note that
						I changed the surface to points
						to make the figure a bit
						cleaner):
						</p><div class="figure"><a id="id904218"></a><p class="title"><b>Figure 3.1. Arc repressor isocontours in VMD</b></p><div class="figure-contents"><div><img src="images/arc-iso-vmd.png" alt="Arc repressor isocontours in VMD" /></div></div></div><p><br class="figure-break" />
					</p></div><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id904234"></a>3.1.4.2. Visualizing surface potentials</h4></div></div></div><p>
						Another popular method of
						electrostatic potential
						visualization maps the
						electrostatic potential to the
						biomolecular surface.  Before
						proceeding, you may want to
						delete the two isocontours you
						just created using the
						<span class="guibutton">Delete
							Rep</span> in the
						Graphical Representations
						window.
					</p><div class="orderedlist"><ol type="1"><li><p>
								Go to the
								Graphical
								Representations
								window
								(<span class="guimenu">Graphics</span> → <span class="guimenuitem">Representations...</span>
								from the VMD
								Main window)
								and create a
								new
								representation
								of the molecule
								with the 
								<span class="guibutton">Create
									Rep</span>
								button.
							</p></li><li><p> Go to the "Draw
								style" tab of
								the Graphical
								Representations
								window and
								change
								<span class="guilabel">Drawing
									Method</span>
								to
								"Surf"<sup>[<a id="id904308" href="#ftn.id904308">5</a>]</sup>
								and
								<span class="guilabel">Coloring
									Method</span>
								to "Volume".
							</p></li><li><p>
								Go to the
								"Trajectory
								tab" of the
								Graphical
								Representations
								window
								and change the
								"<span class="guilabel">Color
									Scale
									Data
									Range:</span>"
								to -10 to 10
								(or whatever
								your favorite
								values are).
							</p></li><li><p>
								Based on your
								version of VMD
								and your
								personal
								preferences,
								you might want
								to change the
								color scale for
								this image.  Go
								to <span class="guimenu">Graphics</span> → <span class="guimenuitem">Colors...</span>
								in the VMD Main
								window and
								select the
								"Color Scale"
								tab from the
								new "Color
								Controls"
								window.  The
								traditional
								coloring scheme
								for
								electrostatics
								is "RWB" (in
								the
								<span class="guilabel">Method</span>
								menu).
							</p></li></ol></div><p>
						Your molecule now probably
						looks like this:
						</p><div class="figure"><a id="id904389"></a><p class="title"><b>Figure 3.2. Arc repressor surface potential in VMD</b></p><div class="figure-contents"><div><img src="images/arc-surf-vmd.png" alt="Arc repressor surface potential in VMD" /></div></div></div><p><br class="figure-break" />
					</p></div></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pymol-sect"></a>3.2. PyMOL</h2></div></div></div><p>
				The <a href="http://pymol.sf.net" target="_top">PyMOL</a> molecular
				graphics software package provides support for
				both the execution of APBS and the
				visualization of the resulting electrostatic
				potentials.  We will provide a basic
				demonstration of how go from a PDB entry to a
				plot of structure &amp; potential in PyMOL using
				APBS.
			</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This tutorial was written using
					PyMOLX11Hybrid 0.99 on a Mac.</p></td></tr></table></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id904436"></a>3.2.1. Generating the PQR</h3></div></div></div><p>We'll perform this example with
					fasciculin-2 (PDB ID <a href="http://www.pdb.org/pdb/explore.do?structureId=1FAS" target="_top">1FAS</a>),
					a snake neurotoxin which binds the
					negatively-charged
					acetylcholinesterase.  Please generate
					the PQR file using the steps outlined
					in <a href="#pdb2pqr-subsect" title="2.3. Generating PQR files from PDB&#10;&#9;&#9;&#9;&#9;files (PDB2PQR)">Section 2.3, “Generating PQR files from PDB
				files (PDB2PQR)”</a>.
				</p><p>Load the PQR file you created into PyMOL
					(<span class="guimenu">File</span> → <span class="guimenuitem">Open...</span>) and choose your favorite
					graphical representation.</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id904481"></a>3.2.2. Performing the electrostatics calcuation
					</h3></div></div></div><p>
					Go to the 
					<span class="guimenu">Plugin</span> → <span class="guimenuitem">APBS
							Tools...</span>
					to open the APBS calculation plugin.
					</p><div class="orderedlist"><ol type="1"><li><p>
								Under the
								"<span class="guilabel">Main</span>"
								tab of the
								PyMOL APBS
								Tools window,
								select
								<span class="guibutton">Use
									another
									PQR</span>
								and either
								browse to (via
								the
								<span class="guibutton">Choose
									Externally
									Generated
									PQR:</span>
								button) or input the
								path to your
								PQR file.  This
								step is
								necessary to
								ensure you use
								the radii and
								charges
								assigned by
								PDB2PQR.
							</p></li><li><p>
								Under the
								"<span class="guilabel">APBS
									Location</span>"
								tab of the
								PyMOL APBS
								Tools window,
								either browse
								to (via the
								<span class="guibutton">APBS
									binary
									location:
									:</span>
								button) or input the
								path to your
								local APBS
								binary.  It is
								not necessary
								to provide a
								path to the
								APBS psize.py
								binary for most
								biomolecules.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Temporary
									File
									Locations</span>"
								tab of the
								PyMOL APBS
								Tools window,
								customize the
								locations of
								the various
								temporary files
								created during
								the run.  This
								can be useful
								if you want to
								save the
								generated files
								for later use.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Configuration</span>"
								tab of the
								PyMOL APBS
								Tools window,
								hit the
								<span class="guibutton">Set
									grid</span>
								to set the grid
								spacings.
								The default
								values are
								usually
								sufficient for
								all but the
								most highly
								charged
								biomolecules.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Configuration</span>"
								tab of the
								PyMOL APBS
								Tools window,
								customize the
								remaining
								parameters; the
								defaults are
								usually
								OK<sup>[<a id="id904626" href="#ftn.id904626">6</a>]</sup>.
							</p></li><li><p>
								Under the
								"<span class="guilabel">Configuration</span>"
								tab of the
								PyMOL APBS
								Tools window,
								hit the
								<span class="guibutton">Run
									APBS</span>
								button to start
								the APBS
								calculation.
								Depending on
								the speed of
								your computer,
								this could take
								a few minutes.
								The
								<span class="guibutton">Run
									APBS</span>
								button will
								become
								unselected when
								the calcaultion
								is finished.
							</p></li></ol></div><p>
				</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id904673"></a>3.2.3. Visualize the electrostatic potential</h3></div></div></div><p> Before proceeding with the remaining
					steps, you must load the electrostatic
					potential data into PyMOL.  Under the
					"<span class="guilabel">Visualization</span>"
					tab of the PyMOL APBS Tools window, hit
					the <span class="guibutton">Update</span>
					button.  </p><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id904697"></a>3.2.3.1. Electrostatic isocontours</h4></div></div></div><p>PyMOL makes this step very easy:
						adjust the positive and
						negative
						"<span class="guilabel">Contour</span>"
						fields to the desired values
						(usually +/-1, +/-5, or +/-10
						kT/e<sup>[<a id="id904714" href="#ftn.id904714">7</a>]</sup>)
						and hit the 
						<span class="guilabel">Positive Isosurface</span>
						and <span class="guilabel">Negative Isosurface</span>
						and <span class="guibutton">Show</span>
						buttons.
					</p><p>
						At this point, you probably
						have a figure that looks
						something like:
						</p><div class="figure"><a id="id904744"></a><p class="title"><b>Figure 3.3. +/- 1 kT/e
							electrostatic potential
							isocontours of FAS2 in PyMOL</b></p><div class="figure-contents"><div><img src="images/fas2-iso-pymol.png" alt="+/- 1 kT/e electrostatic potential isocontours of FAS2 in PyMOL" /></div></div></div><p><br class="figure-break" />
					</p></div><div class="sect3" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="id904760"></a>3.2.3.2. Surface potentials</h4></div></div></div><p>If you haven't already, hide the
						isocontours by hitting
						<span class="guilabel">Positive Isosurface</span>
						and <span class="guilabel">Negative Isosurface</span>
						and <span class="guibutton">Hide</span>
						buttons.
					</p><p>The surface potential is also
						straightforward to visualize.
						Set the 
						"<span class="guilabel">Low</span>"
						and
						"<span class="guilabel">High</span>"
						values to the desired values 
						(usually +/-1, +/-5, or +/-10
						kT/e) at which the surface
						colors are clamped at red (-)
						or blue (+).  Check the
						"<span class="guibutton">Solvent accessible
							surface</span>"
						and "<span class="guibutton">Color by
							potential on sol. acc.
							surf.</span>"
						buttons to plot the potential
						on the solvent-accessible
						(probe-inflated or
						Lee-Richards)
						surface<sup>[<a id="id904822" href="#ftn.id904822">8</a>]</sup>.
						Hit the "<span class="guilabel">Molecular
							Surface</span>"
						<span class="guibutton">Show</span>
						button to load the surface
						potential.
						</p><div class="figure"><a id="id904849"></a><p class="title"><b>Figure 3.4. +/- 5 kT/e
							electrostatic surface potential
							of FAS2 in PyMOL</b></p><div class="figure-contents"><div><img src="images/fas2-surf-pymol.png" alt="+/- 5 kT/e electrostatic surface potential of FAS2 in PyMOL" /></div></div></div><p><br class="figure-break" />
					</p></div></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="pmv-sect"></a>3.3. PMV</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div class="footnote"><p><sup>[<a id="ftn.id903909" href="#id903909">3</a>] </sup> At this point you may
							notice (to many users'
							chagrin) that PDB2PQR
							removed the chain IDs
							from the structure.
							Sorry about this; we're
							trying to fix it in
							future releases of APBS
							and PDB2PQR.</p></div><div class="footnote"><p><sup>[<a id="ftn.id903921" href="#id903921">4</a>] </sup>Visualization
							seems to work best with
							PARSE</p></div><div class="footnote"><p><sup>[<a id="ftn.id904308" href="#id904308">5</a>] </sup>FYI,
										this
										appears
										to
										generate
										a
										molecular
										or
										Connolly
										type
										of
										surface
										rather
										than
										the
										solvent-accessible
										or
										Lee-Richards
										surface
										I
										personally
										prefer
										for
										this
										type
										of
										visualization...</p></div><div class="footnote"><p><sup>[<a id="ftn.id904626" href="#id904626">6</a>] </sup>Although
										I
										usually
										prefer
										0.150
										concentrations
										for
										the
										+1
										and
										-1
										ion
										species
										so
										electrostatic
										properties
										aren't
										overly
										exaggerated.</p></div><div class="footnote"><p><sup>[<a id="ftn.id904714" href="#id904714">7</a>] </sup>Note that
								PyMOL has a
								slight units
								error on the
								contour
								values.</p></div><div class="footnote"><p><sup>[<a id="ftn.id904822" href="#id904822">8</a>] </sup>In my opinion,
								the
								solvent-accessible
								surface tends
								to reveal more
								global features
								of the surface
								potential.
								Tighter
								surfaces (e.g.,
								van der Waals
								and molecular
								or Connolly
								surfaces) tend
								to simply map
								atomic surface
								onto the
								biomolecular
								surface.</p></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="solvation-sect"></a>Chapter 4. How do I calculate a solvation
energy?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id904897">4.1. Polar solvation</a></span></dt><dt><span class="sect1"><a href="#id904909">4.2. Apolar solvation</a></span></dt></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id904897"></a>4.1. Polar solvation</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id904909"></a>4.2. Apolar solvation</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="binding-sect"></a>Chapter 5. How do I calculate a binding
energy?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id904936">5.1. Hey! You don't have any parameters for my
ligand!</a></span></dt><dt><span class="sect1"><a href="#id904948">5.2. Polar contributions</a></span></dt><dt><span class="sect1"><a href="#id904960">5.3. Apolar contributions</a></span></dt></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id904936"></a>5.1. Hey! You don't have any parameters for my
ligand!</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id904948"></a>5.2. Polar contributions</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id904960"></a>5.3. Apolar contributions</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="forces-sect"></a>Chapter 6. How do I calculate solvation
forces?</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id904987">6.1. Polar solvation</a></span></dt><dt><span class="sect1"><a href="#id904998">6.2. Apolar solvation</a></span></dt></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id904987"></a>6.1. Polar solvation</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id904998"></a>6.2. Apolar solvation</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="pka-sect"></a>Chapter 7. How do I calculate a pK<sub>a</sub>?</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="parallel-sect"></a>Chapter 8. My calculation requires too much memory!</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="simulation-sect"></a>Chapter 9. How do I use APBS with my
molecular dynamics program (for MM/PBSA, etc.)?</h2></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/warning.png" /></td><th align="left">Warning</th></tr><tr><td align="left" valign="top"><p>Under construction</p></td></tr></table></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="gemstone-sect"></a>Chapter 10. Can I run APBS via the web?  (Gemstone) </h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id905094">10.1. Getting Gemstone</a></span></dt><dt><span class="sect1"><a href="#id905119">10.2. Preparing a structure with PDB2PQR</a></span></dt><dt><span class="sect1"><a href="#id905231">10.3. Perform an electrostatics calculation with APBS</a></span></dt></dl></div><p>Yes, you can run APBS via the web, thanks to the <a href="http://gemstone.mozdev.org" target="_top">Gemstone</a>
			service.  This section demonstrates how <a href="http://gemstone.mozdev.org" target="_top">Gemstone</a>
			can be used to perform most APBS calculations commonly
			done through the command-line interface.  Better yet,
			it allows you to use <a href="http://nbcr.net" target="_top">NBCR's</a> resources
			instead of your own!  
		</p><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id905094"></a>10.1. Getting Gemstone</h2></div></div></div><p> You need to download and install the Gemstone
				extension for the <a href="http://www.mozilla.com/firefox/" target="_top">Firefox</a>
				web browser from <a href="http://gemstone.mozdev.org" target="_top">http://gemstone.mozdev.org</a>
				before starting this tutorial.</p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id905119"></a>10.2. Preparing a structure with PDB2PQR</h2></div></div></div><p> We'll start by preparing a structure with <a href="http://pdb2pqr.sf.net" target="_top">PDB2PQR</a>.
				First, you need to download a PDB file from the
				<a href="http://www.pdb.org" target="_top">Protein Data
					Bank</a>.  For the purposes of this
				example, we'll use <a href="http://www.pdb.org/pdb/navbarsearch.do?newSearch=yes&amp;inputQuickSearch=1fas" target="_top">1FAS</a>
				in PDB format (download directly <a href="http://www.pdb.org/pdb/downloadFile.do?fileFormat=pdb&amp;compression=NO&amp;structureId=1FAS" target="_top">here</a>).  </p><p> Open the Gemstone interface through the Firefox
				menu <span class="guimenu">Tools</span> → <span class="guimenuitem">Gemstone</span>.  Select the PDB2PQR
					application through the Gemstone menu
					<span class="guimenu">Utils</span> → <span class="guimenuitem">PDB2PQR</span> on the righthand side of
					the Gemstone screen.  Select the PDB
					file you just downloaded and any other
					options for PDB2PQR of interest.  Your
					screen should look something like:
					</p><div class="figure"><a id="id905201"></a><p class="title"><b>Figure 10.1. Gemstone PDB2PQR calculation</b></p><div class="figure-contents"><div><img src="images/gemstone-pdb2pqr.png" alt="Gemstone PDB2PQR calculation" /></div></div></div><p><br class="figure-break" />
					Go ahead and "Run" the Gemstone
					calculation, check the
					<code class="filename">stdOut</code> and
					<code class="filename">stdErr</code> for any
					warning messages, and download the
					resulting PQR file.  </p></div><div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id905231"></a>10.3. Perform an electrostatics calculation with APBS</h2></div></div></div><p>We're now ready to perform an APBS
					calculation of the 1FAS electrostatic
					potential through Gemstone.  Open the
					<span class="guimenu">Chemistry</span> → <span class="guimenuitem">Apbs</span>
					menu on the righthand side of the
					Gemstone screen.  We'll step through
					each of the input tabs in the middle
					pane in the following sections.
				</p><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id905262"></a>10.3.1. Calculation</h3></div></div></div><p>Move to the Calculation tab in
						the middle pane.</p><p>Most of the "Mathematics"
						settings can be left as-is;
						however, feel free to play with
						the discretization and surface
						definitions to see how it
						affects your results.</p><p>Under "Molecules", load the 1FAS
						PQR file you just prepared in
						the previous section.</p><p>Don't select anything under
						"Energy and Force" for this
						calculation.</p><p>At
						this point, your screen should
						look something like this:
						</p><div class="figure"><a id="id905290"></a><p class="title"><b>Figure 10.2. Gemstone APBS/Calculation screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-calculation.png" alt="Gemstone APBS/Calculation screen" /></div></div></div><p><br class="figure-break" />
					</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id905306"></a>10.3.2. Grid</h3></div></div></div><p>Next, move to the Grid tab in the
						middle pane.</p><p>Under "General", enter 97 for X,
						Y, and Z "Grid points".</p><p>Under "Coarse Grid", choose 100
						for all X, Y, and Z "Lengths".
						Center the mesh on the
						molecule.</p><p>Under "Fine Grid", choose 80 for
						all X, Y, and Z "Lengths".
						Center the mesh on the
						molecule.</p><p>Leave the "Parallel Execution"
						alone for this
						calculation.</p><p>At this point, your screen should
						look something like this:
						</p><div class="figure"><a id="id905339"></a><p class="title"><b>Figure 10.3. Gemstone APBS/Grid screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-grid.png" alt="Gemstone APBS/Grid screen" /></div></div></div><p><br class="figure-break" />
					</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id905354"></a>10.3.3. Physics</h3></div></div></div><p>Next, move to the Physics tab in
						the middle pane.</p><p>Choose any values you like here;
						the defaults should be fine for
						most visualization
						calculations.</p><p>At this point, your screen should
						look something like this:
						</p><div class="figure"><a id="id905373"></a><p class="title"><b>Figure 10.4. Gemstone APBS/Physics screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-physics.png" alt="Gemstone APBS/Physics screen" /></div></div></div><p><br class="figure-break" />
					</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id905389"></a>10.3.4. File I/O </h3></div></div></div><p>Next, move to the File I/O tab in
						the middle pane.</p><p>Unless you have other properties
						you wan to visualize, you can
						leave these settings
						as-is.</p><p>At this point, your screen should
						look something like this:
						</p><div class="figure"><a id="id905408"></a><p class="title"><b>Figure 10.5. Gemstone APBS/File I/O screen</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-file.png" alt="Gemstone APBS/File I/O screen" /></div></div></div><p><br class="figure-break" />
						</p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id905423"></a>10.3.5. Running the calculation</h3></div></div></div><p>Finally, return to the Calculation tab
					and select "Run APBS".  After a while,
					the results will appear under the
					Output tab in the middle pane.  When
					the run is complete, you should see
					something like this:
					</p><div class="figure"><a id="id905435"></a><p class="title"><b>Figure 10.6. Gemstone APBS/Calculation screen (run complete)</b></p><div class="figure-contents"><div><img src="images/gemstone-apbs-finished.png" alt="Gemstone APBS/Calculation screen (run complete)" /></div></div></div><p><br class="figure-break" />
					In particular, you should have the
					option to save the potential file
					calculated in this APBS run.  </p></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id905454"></a>10.3.6. Other calculations</h3></div></div></div><p>Nearly all of the examples in this
					tutorial can also be performed with
					Gemstone.  Furthermore, input files can
					be uploaded to use Gemstone as a
					"portal" to web services at other
					institutions. </p></div></div></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="more-sect"></a>Chapter 11. More examples...</h2></div></div></div><p> In addition to the relatively simple applications
			presented here, there are a number of additional
			examples distributed with the APBS software package
			(<a href="http://apbs.sf.net" target="_top">http://apbs.sf.net</a>) which
			include ionization energies, protein-protein
			interactions, parallel calculations, etc.  </p></div><div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="help-sect"></a>Chapter 12. None of this answered my question...</h2></div></div></div><p>Please visit the <a href="http://lists.sourceforge.net/mailman/listinfo/apbs-users" target="_top">APBS-users
				mailing list</a>.  After you've looked for
			the answer to your question in the <a href="http://sourceforge.net/mailarchive/forum.php?forum_id=46597" target="_top">archive</a>,
			please post it to the mailing list. </p></div></div></body></html>
