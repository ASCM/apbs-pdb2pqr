<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>APBS: Vfetk class</title>
<link href="apbs.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>Vfetk class</h1>FEtk master class (interface between FEtk and APBS).  
<a href="#_details">More...</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vfetk_8h.html">vfetk.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Contains declarations for class Vfetk. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="vfetk_8c.html">vfetk.c</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Class Vfetk methods. <br></td></tr>

<p>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsVfetk.html">sVfetk</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Contains public data members for Vfetk class/module.  <a href="structsVfetk.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsVfetk__LocalVar.html">sVfetk_LocalVar</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Vfetk LocalVar subclass<p>
Contains variables used when solving the PDE with FEtk.  <a href="structsVfetk__LocalVar.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g925ca870e2f549e3959f5a4c13353be2"></a><!-- doxytag: member="Vfetk::VRINGMAX" ref="g925ca870e2f549e3959f5a4c13353be2" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g925ca870e2f549e3959f5a4c13353be2">VRINGMAX</a>&nbsp;&nbsp;&nbsp;1000</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum number of simplices in a simplex ring. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g85534b6bb193629d9d1fd9dada92aacf"></a><!-- doxytag: member="Vfetk::VATOMMAX" ref="g85534b6bb193629d9d1fd9dada92aacf" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g85534b6bb193629d9d1fd9dada92aacf">VATOMMAX</a>&nbsp;&nbsp;&nbsp;1000000</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum number of atoms associated with a vertex. <br></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gd4ff27df517f29ff2c62c8ea09072a9a"></a><!-- doxytag: member="Vfetk::Vfetk_LsolvType" ref="gd4ff27df517f29ff2c62c8ea09072a9a" args="" -->
typedef enum <a class="el" href="group__Vfetk.html#g0907bf1ea39b217715a8e6fb480bcaeb">eVfetk_LsolvType</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gd4ff27df517f29ff2c62c8ea09072a9a">Vfetk_LsolvType</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare FEMparm_LsolvType type. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g0ae7e4598a4dfa736d291a33d341c808"></a><!-- doxytag: member="Vfetk::Vfetk_MeshLoad" ref="g0ae7e4598a4dfa736d291a33d341c808" args="" -->
typedef enum <a class="el" href="group__Vfetk.html#g983fd714f6d8ee74257eb04fd85f7e64">eVfetk_MeshLoad</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g0ae7e4598a4dfa736d291a33d341c808">Vfetk_MeshLoad</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare FEMparm_GuessType type. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g9eb08aef7e138157fb80fae1e4734bfd"></a><!-- doxytag: member="Vfetk::Vfetk_NsolvType" ref="g9eb08aef7e138157fb80fae1e4734bfd" args="" -->
typedef enum <a class="el" href="group__Vfetk.html#gc13393fb20a9b60fbc804cc2da797994">eVfetk_NsolvType</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g9eb08aef7e138157fb80fae1e4734bfd">Vfetk_NsolvType</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare FEMparm_NsolvType type. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g43a9e71e84198968cbe25331e23a9946"></a><!-- doxytag: member="Vfetk::Vfetk_GuessType" ref="g43a9e71e84198968cbe25331e23a9946" args="" -->
typedef enum <a class="el" href="group__Vfetk.html#ge86ea86a8b8b90820e4ffe91a2528303">eVfetk_GuessType</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g43a9e71e84198968cbe25331e23a9946">Vfetk_GuessType</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare FEMparm_GuessType type. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gf1c9f6712d62ba31b38ebbcface6eaf5"></a><!-- doxytag: member="Vfetk::Vfetk_PrecType" ref="gf1c9f6712d62ba31b38ebbcface6eaf5" args="" -->
typedef enum <a class="el" href="group__Vfetk.html#gdc47cb025e2518628d09b7522c5ce9e0">eVfetk_PrecType</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gf1c9f6712d62ba31b38ebbcface6eaf5">Vfetk_PrecType</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare FEMparm_GuessType type. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g3278b87b37cf1911f986521b40a9e7f7"></a><!-- doxytag: member="Vfetk::Vfetk_LocalVar" ref="g3278b87b37cf1911f986521b40a9e7f7" args="" -->
typedef <a class="el" href="structsVfetk__LocalVar.html">sVfetk_LocalVar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g3278b87b37cf1911f986521b40a9e7f7">Vfetk_LocalVar</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declaration of the Vfetk_LocalVar subclass as the Vfetk_LocalVar structure. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gd4361408b637321dd777408c6e79e191"></a><!-- doxytag: member="Vfetk::Vfetk" ref="gd4361408b637321dd777408c6e79e191" args="" -->
typedef <a class="el" href="structsVfetk.html">sVfetk</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gd4361408b637321dd777408c6e79e191">Vfetk</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declaration of the Vfetk class as the Vfetk structure. <br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g0907bf1ea39b217715a8e6fb480bcaeb">eVfetk_LsolvType</a> { <br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gg0907bf1ea39b217715a8e6fb480bcaeb79c08336fe9f91bca81326cb24628579">VLT_SLU</a> = 0, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gg0907bf1ea39b217715a8e6fb480bcaebc922b471c1bebe4fdee86bb62420ef50">VLT_MG</a> = 1, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gg0907bf1ea39b217715a8e6fb480bcaebc7a1fcaf1acae2239ed423e062b8da3e">VLT_CG</a> = 2, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gg0907bf1ea39b217715a8e6fb480bcaeb9e8ddc8d7e06a0c00e6b11c3d795358a">VLT_BCG</a> = 3
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Linear solver type.  <a href="group__Vfetk.html#g0907bf1ea39b217715a8e6fb480bcaeb">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g983fd714f6d8ee74257eb04fd85f7e64">eVfetk_MeshLoad</a> { <br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gg983fd714f6d8ee74257eb04fd85f7e64741922e00a746924cfab60586427bda3">VML_DIRICUBE</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gg983fd714f6d8ee74257eb04fd85f7e6482aafe9b8ad86202e5db686dc5a8a3c8">VML_NEUMCUBE</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gg983fd714f6d8ee74257eb04fd85f7e64915bea688c881263d25d8026f8d3fddd">VML_EXTERNAL</a>
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mesh loading operation.  <a href="group__Vfetk.html#g983fd714f6d8ee74257eb04fd85f7e64">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gc13393fb20a9b60fbc804cc2da797994">eVfetk_NsolvType</a> { <br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#ggc13393fb20a9b60fbc804cc2da7979941a4fdde4d4a9515af300ef23b6d7acdd">VNT_NEW</a> = 0, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#ggc13393fb20a9b60fbc804cc2da79799417ef9aaa047d540a59688087090ea31e">VNT_INC</a> = 1, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#ggc13393fb20a9b60fbc804cc2da7979941adcc75d4f8f810301c7012aa612d8dc">VNT_ARC</a> = 2
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Non-linear solver type.  <a href="group__Vfetk.html#gc13393fb20a9b60fbc804cc2da797994">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#ge86ea86a8b8b90820e4ffe91a2528303">eVfetk_GuessType</a> { <br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gge86ea86a8b8b90820e4ffe91a2528303cef2f75da1dede20ad46617c90cedf7d">VGT_ZERO</a> = 0, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gge86ea86a8b8b90820e4ffe91a25283032031ed6ed19f69a42fb498e1862d3030">VGT_DIRI</a> = 1, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#gge86ea86a8b8b90820e4ffe91a252830337c983520e9dc5f189afd2f8778a5e3c">VGT_PREV</a> = 2
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initial guess type.  <a href="group__Vfetk.html#ge86ea86a8b8b90820e4ffe91a2528303">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gdc47cb025e2518628d09b7522c5ce9e0">eVfetk_PrecType</a> { <br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#ggdc47cb025e2518628d09b7522c5ce9e06219934b8d4d5e4a847dc3f75ffe9432">VPT_IDEN</a> = 0, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#ggdc47cb025e2518628d09b7522c5ce9e03a149ed46e9f4ac954676f197573a099">VPT_DIAG</a> = 1, 
<br>
&nbsp;&nbsp;<a class="el" href="group__Vfetk.html#ggdc47cb025e2518628d09b7522c5ce9e0421cf15849be3c69439c2cffec1ec887">VPT_MG</a> = 2
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Preconditioner type.  <a href="group__Vfetk.html#gdc47cb025e2518628d09b7522c5ce9e0">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Gem *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#ge996913edc49d3be58cfad38cf2ead4d">Vfetk_getGem</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a pointer to the Gem (grid manager) object.  <a href="#ge996913edc49d3be58cfad38cf2ead4d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">AM *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gf9e2cfba465b60e1cbd0fa228f969596">Vfetk_getAM</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a pointer to the AM (algebra manager) object.  <a href="#gf9e2cfba465b60e1cbd0fa228f969596"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structsVpbe.html">Vpbe</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g1231ccdd3888cc5f45ade93470c4cd1b">Vfetk_getVpbe</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a pointer to the Vpbe (PBE manager) object.  <a href="#g1231ccdd3888cc5f45ade93470c4cd1b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structsVcsm.html">Vcsm</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#ge16c17016c3f527e1639f0e2e2ece7f3">Vfetk_getVcsm</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a pointer to the Vcsm (charge-simplex map) object.  <a href="#ge16c17016c3f527e1639f0e2e2ece7f3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g64e3f8c9df71e989da14be147d378625">Vfetk_getAtomColor</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, int iatom)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the partition information for a particular atom.  <a href="#g64e3f8c9df71e989da14be147d378625"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g851988acbdf7739d5bd979defe7ae90d">Vfetk_ctor</a> (<a class="el" href="structsVpbe.html">Vpbe</a> *pbe, <a class="el" href="group__Vhal.html#ga0aabb1579af98f26effe7796b2d0a0c">Vhal_PBEType</a> type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for Vfetk object.  <a href="#g851988acbdf7739d5bd979defe7ae90d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g8c63795e10686e806cb369af8f543387">Vfetk_ctor2</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, <a class="el" href="structsVpbe.html">Vpbe</a> *pbe, <a class="el" href="group__Vhal.html#ga0aabb1579af98f26effe7796b2d0a0c">Vhal_PBEType</a> type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FORTRAN stub constructor for Vfetk object.  <a href="#g8c63795e10686e806cb369af8f543387"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g79f12393399e3ba28244d96dbd0bca4e">Vfetk_dtor</a> (<a class="el" href="structsVfetk.html">Vfetk</a> **thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Object destructor.  <a href="#g79f12393399e3ba28244d96dbd0bca4e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gc300393d5c7bdda4b66389a24127d138">Vfetk_dtor2</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FORTRAN stub object destructor.  <a href="#gc300393d5c7bdda4b66389a24127d138"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g414150bb3abf21e2d461b7fd596befa9">Vfetk_getSolution</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, int *length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create an array containing the solution (electrostatic potential in units of <img class="formulaInl" alt="$k_B T/e$" src="form_48.png">) at the finest mesh level.  <a href="#g414150bb3abf21e2d461b7fd596befa9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gf64eaf3618d20138562a8cc5ba595f28">Vfetk_setParameters</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, <a class="el" href="structsPBEparm.html">PBEparm</a> *pbeparm, <a class="el" href="structsFEMparm.html">FEMparm</a> *feparm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the parameter objects.  <a href="#gf64eaf3618d20138562a8cc5ba595f28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g8d59079781d2ee65d5073de3b63c530a">Vfetk_energy</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, int color, int nonlin)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the total electrostatic energy.  <a href="#g8d59079781d2ee65d5073de3b63c530a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g8fe6ab903982db4198a1d075b9ff5021">Vfetk_dqmEnergy</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, int color)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the "mobile charge" and "polarization" contributions to the electrostatic energy.  <a href="#g8fe6ab903982db4198a1d075b9ff5021"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gdfc571213f31e96d961f0828fa8fcda7">Vfetk_qfEnergy</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, int color)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the "fixed charge" contribution to the electrostatic energy.  <a href="#gdfc571213f31e96d961f0828fa8fcda7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g1317d1cbf17e934f5b88f9238bf763f6">Vfetk_memChk</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the memory used by this structure (and its contents) in bytes.  <a href="#g1317d1cbf17e934f5b88f9238bf763f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g4be8c4c7a641a5fa2c5f8e2ae02d00fb">Vfetk_setAtomColors</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Transfer color (partition ID) information frmo a partitioned mesh to the atoms.  <a href="#g4be8c4c7a641a5fa2c5f8e2ae02d00fb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g5b3d793fc3603320481b598c85f2201d">Bmat_printHB</a> (Bmat *thee, char *fname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Writes a Bmat to disk in Harwell-Boeing sparse matrix format.  <a href="#g5b3d793fc3603320481b598c85f2201d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Vrc_Codes&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#ge473241047881ecd91d72cba8b037999">Vfetk_genCube</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, double center[3], double length[3], <a class="el" href="group__Vfetk.html#g0ae7e4598a4dfa736d291a33d341c808">Vfetk_MeshLoad</a> meshType)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct a rectangular mesh (in the current Vfetk object).  <a href="#ge473241047881ecd91d72cba8b037999"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Vrc_Codes&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gfd508383dd1b2fbcacad0aee73373b57">Vfetk_loadMesh</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, double center[3], double length[3], <a class="el" href="group__Vfetk.html#g0ae7e4598a4dfa736d291a33d341c808">Vfetk_MeshLoad</a> meshType, Vio *sock)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Loads a mesh into the Vfetk (and associated) object(s).  <a href="#gfd508383dd1b2fbcacad0aee73373b57"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">PDE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g4bb67f5500dd28dcd582d920b50d0b4e">Vfetk_PDE_ctor</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *fetk)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructs the FEtk PDE object.  <a href="#g4bb67f5500dd28dcd582d920b50d0b4e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g40b301931083038af40312b49b167794">Vfetk_PDE_ctor2</a> (PDE *thee, <a class="el" href="structsVfetk.html">Vfetk</a> *fetk)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Intializes the FEtk PDE object.  <a href="#g40b301931083038af40312b49b167794"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gf53be91ac6774829c8f377c15dda8ea5">Vfetk_PDE_dtor</a> (PDE **thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroys FEtk PDE object.  <a href="#gf53be91ac6774829c8f377c15dda8ea5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gea58e1b29973b503b24ef85c08320253">Vfetk_PDE_dtor2</a> (PDE *thee)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FORTRAN stub: destroys FEtk PDE object.  <a href="#gea58e1b29973b503b24ef85c08320253"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g850c1f0593b2b3ba8ad2795b5642d340">Vfetk_PDE_initAssemble</a> (PDE *thee, int ip[], double rp[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do once-per-assembly initialization.  <a href="#g850c1f0593b2b3ba8ad2795b5642d340"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gecb946cbd53bd9aeddd67c1e4494b6fa">Vfetk_PDE_initElement</a> (PDE *thee, int elementType, int chart, double tvx[][VAPBS_DIM], void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do once-per-element initialization.  <a href="#gecb946cbd53bd9aeddd67c1e4494b6fa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g92f682b4b349b1236be7306b8091a6f0">Vfetk_PDE_initFace</a> (PDE *thee, int faceType, int chart, double tnvec[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do once-per-face initialization.  <a href="#g92f682b4b349b1236be7306b8091a6f0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gb2c9190ba012844d51836146e4c0a6c1">Vfetk_PDE_initPoint</a> (PDE *thee, int pointType, int chart, double txq[], double tU[], double tdU[][VAPBS_DIM])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do once-per-point initialization.  <a href="#gb2c9190ba012844d51836146e4c0a6c1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g6ab828dbe466030949f3332a6370a22a">Vfetk_PDE_Fu</a> (PDE *thee, int key, double F[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate strong form of PBE. For interior points, this is: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ -\nabla \cdot \epsilon \nabla u + b(u) - f \]" src="form_56.png">
<p>
 where <img class="formulaInl" alt="$b(u)$" src="form_57.png"> is the (possibly nonlinear) mobile ion term and <img class="formulaInl" alt="$f$" src="form_58.png"> is the source charge distribution term (for PBE) or the induced surface charge distribution (for RPBE). For an interior-boundary (simplex face) point, this is: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ [\epsilon(x) \nabla u(x) \cdot n(x)]_{x=0^+} - [\epsilon(x) \nabla u(x) \cdot n(x)]_{x=0^-} \]" src="form_59.png">
<p>
 where <img class="formulaInl" alt="$n(x)$" src="form_60.png"> is the normal to the simplex face and the term represents the jump in dielectric displacement across the face. There is no outer-boundary contribution for this problem.  <a href="#g6ab828dbe466030949f3332a6370a22a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gd8bfaaca31087ca5c98663f1a9839bcc">Vfetk_PDE_Fu_v</a> (PDE *thee, int key, double V[], double dV[][VAPBS_DIM])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is the weak form of the PBE; i.e. the strong form integrated with a test function to give: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_\Omega \left[ \epsilon \nabla u \cdot \nabla v + b(u) v - f v \right] dx \]" src="form_61.png">
<p>
 where <img class="formulaInl" alt="$b(u)$" src="form_57.png"> denotes the mobile ion term.  <a href="#gd8bfaaca31087ca5c98663f1a9839bcc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g58889daff822d088b8286402228eb8e2">Vfetk_PDE_DFu_wv</a> (PDE *thee, int key, double W[], double dW[][VAPBS_DIM], double V[], double dV[][VAPBS_DIM])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is the linearization of the weak form of the PBE; e.g., for use in a Newton iteration. This is the functional linearization of the strong form integrated with a test function to give: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_\Omega \left[ \epsilon \nabla w \cdot \nabla v + b'(u) w v - f v \right] dx \]" src="form_62.png">
<p>
 where <img class="formulaInl" alt="$b'(u)$" src="form_63.png"> denotes the functional derivation of the mobile ion term.  <a href="#g58889daff822d088b8286402228eb8e2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gd8b11d6436d7ea407c94ac79eb1f9e99">Vfetk_PDE_delta</a> (PDE *thee, int type, int chart, double txq[], void *user, double F[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate a (discretized) delta function source term at the given point.  <a href="#gd8b11d6436d7ea407c94ac79eb1f9e99"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gc37aeabeafd642e7a67b0654497ce2ab">Vfetk_PDE_u_D</a> (PDE *thee, int type, int chart, double txq[], double F[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate the Dirichlet boundary condition at the given point.  <a href="#gc37aeabeafd642e7a67b0654497ce2ab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g0d6f246e3a44d57b2907972efe97bb14">Vfetk_PDE_u_T</a> (PDE *thee, int type, int chart, double txq[], double F[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate the "true solution" at the given point for comparison with the numerical solution.  <a href="#g0d6f246e3a44d57b2907972efe97bb14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g877160adf876489f6493322cf34831d9">Vfetk_PDE_bisectEdge</a> (int dim, int dimII, int edgeType, int chart[], double vx[][VAPBS_DIM])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define the way manifold edges are bisected.  <a href="#g877160adf876489f6493322cf34831d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gab7c03cc5568407794999c0f617ab889">Vfetk_PDE_mapBoundary</a> (int dim, int dimII, int vertexType, int chart, double vx[VAPBS_DIM])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Map a boundary point to some pre-defined shape.  <a href="#gab7c03cc5568407794999c0f617ab889"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gc35880a0b1dcab29fb0eb12aeae116b2">Vfetk_PDE_markSimplex</a> (int dim, int dimII, int simplexType, int faceType[VAPBS_NVS], int vertexType[VAPBS_NVS], int chart[], double vx[][VAPBS_DIM], void *simplex)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">User-defined error estimator -- in our case, a geometry-based refinement method; forcing simplex refinement at the dielectric boundary and (for non-regularized PBE) the charges.  <a href="#gc35880a0b1dcab29fb0eb12aeae116b2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g0e48a1a433ae34229a1cf5157260eb8c">Vfetk_PDE_oneChart</a> (int dim, int dimII, int objType, int chart[], double vx[][VAPBS_DIM], int dimV)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unify the chart for different coordinate systems -- a no-op for us.  <a href="#g0e48a1a433ae34229a1cf5157260eb8c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gcd6aede0ecf4ee5b7cd103a68a28aeee">Vfetk_PDE_Ju</a> (PDE *thee, int key)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Energy functional. This returns the energy (less delta function terms) in the form: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ c^{-1}/2 \int (\epsilon (\nabla u)^2 + \kappa^2 (cosh u - 1)) dx \]" src="form_64.png">
<p>
 for a 1:1 electrolyte where <img class="formulaInl" alt="$c$" src="form_65.png"> is the output from Vpbe_getZmagic.  <a href="#gcd6aede0ecf4ee5b7cd103a68a28aeee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g130f353b0f7c1c432f9e208a43e645b1">Vfetk_externalUpdateFunction</a> (SS **simps, int num)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">External hook to simplex subdivision routines in Gem. Called each time a simplex is subdivided (we use it to update the charge-simplex map).  <a href="#g130f353b0f7c1c432f9e208a43e645b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g0ba7af67b39b140e8150e5699eb2ad31">Vfetk_PDE_simplexBasisInit</a> (int key, int dim, int comp, int *ndof, int dof[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the bases for the trial or the test space, for a particular component of the system, at all quadrature points on the master simplex element.  <a href="#g0ba7af67b39b140e8150e5699eb2ad31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gb42e012aef0ff3f23862dacdbaf86f0a">Vfetk_PDE_simplexBasisForm</a> (int key, int dim, int comp, int pdkey, double xq[], double basis[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate the bases for the trial or test space, for a particular component of the system, at all quadrature points on the master simplex element.  <a href="#gb42e012aef0ff3f23862dacdbaf86f0a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gcc1cb65fc774540f00795cfde20d9532">Vfetk_readMesh</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, int skey, Vio *sock)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read in mesh and initialize associated internal structures.  <a href="#gcc1cb65fc774540f00795cfde20d9532"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g2f59ed59d82530c900326b5aa6f101cd">Vfetk_dumpLocalVar</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Debugging routine to print out local variables used by PDE object.  <a href="#g2f59ed59d82530c900326b5aa6f101cd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gc16966273dd20c0a4eb7e3ef7f2f0d84">Vfetk_fillArray</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, Bvec *vec, <a class="el" href="group__Vhal.html#gdfc214425db779e6548c11fab04ab043">Vdata_Type</a> type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fill an array with the specified data.  <a href="#gc16966273dd20c0a4eb7e3ef7f2f0d84"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#g40b0e35447fa6d193bd2fdf2f4a0a86d">Vfetk_write</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, const char *iodev, const char *iofmt, const char *thost, const char *fname, Bvec *vec, <a class="el" href="group__Vhal.html#gc4f593940585c6a15518f6a7e60ac255">Vdata_Format</a> format)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write out data.  <a href="#g40b0e35447fa6d193bd2fdf2f4a0a86d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Vrc_Codes&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Vfetk.html#gd6be15a2e00968d685a09131436bcc10">Vfetk_loadGem</a> (<a class="el" href="structsVfetk.html">Vfetk</a> *thee, Gem *gm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Load a Gem geometry manager object into Vfetk.  <a href="#gd6be15a2e00968d685a09131436bcc10"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
FEtk master class (interface between FEtk and APBS). 
<p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="ge86ea86a8b8b90820e4ffe91a2528303"></a><!-- doxytag: member="vfetk.h::eVfetk_GuessType" ref="ge86ea86a8b8b90820e4ffe91a2528303" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="group__Vfetk.html#ge86ea86a8b8b90820e4ffe91a2528303">eVfetk_GuessType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initial guess type. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gge86ea86a8b8b90820e4ffe91a2528303cef2f75da1dede20ad46617c90cedf7d"></a><!-- doxytag: member="VGT_ZERO" ref="gge86ea86a8b8b90820e4ffe91a2528303cef2f75da1dede20ad46617c90cedf7d" args="" -->VGT_ZERO</em>&nbsp;</td><td>
Zero initial guess </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gge86ea86a8b8b90820e4ffe91a25283032031ed6ed19f69a42fb498e1862d3030"></a><!-- doxytag: member="VGT_DIRI" ref="gge86ea86a8b8b90820e4ffe91a25283032031ed6ed19f69a42fb498e1862d3030" args="" -->VGT_DIRI</em>&nbsp;</td><td>
Dirichlet boundary condition initial guess </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gge86ea86a8b8b90820e4ffe91a252830337c983520e9dc5f189afd2f8778a5e3c"></a><!-- doxytag: member="VGT_PREV" ref="gge86ea86a8b8b90820e4ffe91a252830337c983520e9dc5f189afd2f8778a5e3c" args="" -->VGT_PREV</em>&nbsp;</td><td>
Previous level initial guess </td></tr>
</table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="g0907bf1ea39b217715a8e6fb480bcaeb"></a><!-- doxytag: member="vfetk.h::eVfetk_LsolvType" ref="g0907bf1ea39b217715a8e6fb480bcaeb" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="group__Vfetk.html#g0907bf1ea39b217715a8e6fb480bcaeb">eVfetk_LsolvType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Linear solver type. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg0907bf1ea39b217715a8e6fb480bcaeb79c08336fe9f91bca81326cb24628579"></a><!-- doxytag: member="VLT_SLU" ref="gg0907bf1ea39b217715a8e6fb480bcaeb79c08336fe9f91bca81326cb24628579" args="" -->VLT_SLU</em>&nbsp;</td><td>
SuperLU direct solve </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg0907bf1ea39b217715a8e6fb480bcaebc922b471c1bebe4fdee86bb62420ef50"></a><!-- doxytag: member="VLT_MG" ref="gg0907bf1ea39b217715a8e6fb480bcaebc922b471c1bebe4fdee86bb62420ef50" args="" -->VLT_MG</em>&nbsp;</td><td>
Multigrid </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg0907bf1ea39b217715a8e6fb480bcaebc7a1fcaf1acae2239ed423e062b8da3e"></a><!-- doxytag: member="VLT_CG" ref="gg0907bf1ea39b217715a8e6fb480bcaebc7a1fcaf1acae2239ed423e062b8da3e" args="" -->VLT_CG</em>&nbsp;</td><td>
Conjugate gradient </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg0907bf1ea39b217715a8e6fb480bcaeb9e8ddc8d7e06a0c00e6b11c3d795358a"></a><!-- doxytag: member="VLT_BCG" ref="gg0907bf1ea39b217715a8e6fb480bcaeb9e8ddc8d7e06a0c00e6b11c3d795358a" args="" -->VLT_BCG</em>&nbsp;</td><td>
BiCGStab </td></tr>
</table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="g983fd714f6d8ee74257eb04fd85f7e64"></a><!-- doxytag: member="vfetk.h::eVfetk_MeshLoad" ref="g983fd714f6d8ee74257eb04fd85f7e64" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="group__Vfetk.html#g983fd714f6d8ee74257eb04fd85f7e64">eVfetk_MeshLoad</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Mesh loading operation. 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg983fd714f6d8ee74257eb04fd85f7e64741922e00a746924cfab60586427bda3"></a><!-- doxytag: member="VML_DIRICUBE" ref="gg983fd714f6d8ee74257eb04fd85f7e64741922e00a746924cfab60586427bda3" args="" -->VML_DIRICUBE</em>&nbsp;</td><td>
Dirichlet cube </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg983fd714f6d8ee74257eb04fd85f7e6482aafe9b8ad86202e5db686dc5a8a3c8"></a><!-- doxytag: member="VML_NEUMCUBE" ref="gg983fd714f6d8ee74257eb04fd85f7e6482aafe9b8ad86202e5db686dc5a8a3c8" args="" -->VML_NEUMCUBE</em>&nbsp;</td><td>
Neumann cube </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg983fd714f6d8ee74257eb04fd85f7e64915bea688c881263d25d8026f8d3fddd"></a><!-- doxytag: member="VML_EXTERNAL" ref="gg983fd714f6d8ee74257eb04fd85f7e64915bea688c881263d25d8026f8d3fddd" args="" -->VML_EXTERNAL</em>&nbsp;</td><td>
External mesh (from socket) </td></tr>
</table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="gc13393fb20a9b60fbc804cc2da797994"></a><!-- doxytag: member="vfetk.h::eVfetk_NsolvType" ref="gc13393fb20a9b60fbc804cc2da797994" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="group__Vfetk.html#gc13393fb20a9b60fbc804cc2da797994">eVfetk_NsolvType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Non-linear solver type. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="ggc13393fb20a9b60fbc804cc2da7979941a4fdde4d4a9515af300ef23b6d7acdd"></a><!-- doxytag: member="VNT_NEW" ref="ggc13393fb20a9b60fbc804cc2da7979941a4fdde4d4a9515af300ef23b6d7acdd" args="" -->VNT_NEW</em>&nbsp;</td><td>
Newton solver </td></tr>
<tr><td valign="top"><em><a class="anchor" name="ggc13393fb20a9b60fbc804cc2da79799417ef9aaa047d540a59688087090ea31e"></a><!-- doxytag: member="VNT_INC" ref="ggc13393fb20a9b60fbc804cc2da79799417ef9aaa047d540a59688087090ea31e" args="" -->VNT_INC</em>&nbsp;</td><td>
Incremental </td></tr>
<tr><td valign="top"><em><a class="anchor" name="ggc13393fb20a9b60fbc804cc2da7979941adcc75d4f8f810301c7012aa612d8dc"></a><!-- doxytag: member="VNT_ARC" ref="ggc13393fb20a9b60fbc804cc2da7979941adcc75d4f8f810301c7012aa612d8dc" args="" -->VNT_ARC</em>&nbsp;</td><td>
Psuedo-arclength </td></tr>
</table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="gdc47cb025e2518628d09b7522c5ce9e0"></a><!-- doxytag: member="vfetk.h::eVfetk_PrecType" ref="gdc47cb025e2518628d09b7522c5ce9e0" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="group__Vfetk.html#gdc47cb025e2518628d09b7522c5ce9e0">eVfetk_PrecType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Preconditioner type. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Do not change these values; they correspond to settings in FEtk </dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="ggdc47cb025e2518628d09b7522c5ce9e06219934b8d4d5e4a847dc3f75ffe9432"></a><!-- doxytag: member="VPT_IDEN" ref="ggdc47cb025e2518628d09b7522c5ce9e06219934b8d4d5e4a847dc3f75ffe9432" args="" -->VPT_IDEN</em>&nbsp;</td><td>
Identity matrix </td></tr>
<tr><td valign="top"><em><a class="anchor" name="ggdc47cb025e2518628d09b7522c5ce9e03a149ed46e9f4ac954676f197573a099"></a><!-- doxytag: member="VPT_DIAG" ref="ggdc47cb025e2518628d09b7522c5ce9e03a149ed46e9f4ac954676f197573a099" args="" -->VPT_DIAG</em>&nbsp;</td><td>
Diagonal scaling </td></tr>
<tr><td valign="top"><em><a class="anchor" name="ggdc47cb025e2518628d09b7522c5ce9e0421cf15849be3c69439c2cffec1ec887"></a><!-- doxytag: member="VPT_MG" ref="ggdc47cb025e2518628d09b7522c5ce9e0421cf15849be3c69439c2cffec1ec887" args="" -->VPT_MG</em>&nbsp;</td><td>
Multigrid </td></tr>
</table>
</dl>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g5b3d793fc3603320481b598c85f2201d"></a><!-- doxytag: member="vfetk.h::Bmat_printHB" ref="g5b3d793fc3603320481b598c85f2201d" args="(Bmat *thee, char *fname)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Bmat_printHB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Bmat *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fname</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Writes a Bmat to disk in Harwell-Boeing sparse matrix format. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Stephen Bond </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This is a friend function of Bmat </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000009">Bug:</a></b></dt><dd>Hardwired to only handle the single block symmetric case. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fname</em>&nbsp;</td><td>
The matrix to write Filename for output </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g851988acbdf7739d5bd979defe7ae90d"></a><!-- doxytag: member="vfetk.h::Vfetk_ctor" ref="g851988acbdf7739d5bd979defe7ae90d" args="(Vpbe *pbe, Vhal_PBEType type)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a>* Vfetk_ctor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVpbe.html">Vpbe</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pbe</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__Vhal.html#ga0aabb1579af98f26effe7796b2d0a0c">Vhal_PBEType</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor for Vfetk object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to newly allocated Vfetk object </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This sets up the Gem, AM, and Aprx FEtk objects but does not create a mesh. The easiest way to create a mesh is to then call Vfetk_genCube </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>type</em>&nbsp;</td><td>
Vpbe (PBE manager object) Version of PBE to solve </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g8c63795e10686e806cb369af8f543387"></a><!-- doxytag: member="vfetk.h::Vfetk_ctor2" ref="g8c63795e10686e806cb369af8f543387" args="(Vfetk *thee, Vpbe *pbe, Vhal_PBEType type)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Vfetk_ctor2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structsVpbe.html">Vpbe</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pbe</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__Vhal.html#ga0aabb1579af98f26effe7796b2d0a0c">Vhal_PBEType</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
FORTRAN stub constructor for Vfetk object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This sets up the Gem, AM, and Aprx FEtk objects but does not create a mesh. The easiest way to create a mesh is to then call Vfetk_genCube </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>pbe</em>&nbsp;</td><td>
Vfetk object memory </td></tr>
<tr><td valign="top"><em>type</em>&nbsp;</td><td>
PBE manager object Version of PBE to solve </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g8fe6ab903982db4198a1d075b9ff5021"></a><!-- doxytag: member="vfetk.h::Vfetk_dqmEnergy" ref="g8fe6ab903982db4198a1d075b9ff5021" args="(Vfetk *thee, int color)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Vfetk_dqmEnergy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>color</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the "mobile charge" and "polarization" contributions to the electrostatic energy. 
<p>
Using the solution at the finest mesh level, get the electrostatic energy due to the interaction of the mobile charges with the potential and polarization of the dielectric medium: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ G = \frac{1}{4 I_s} \sum_i c_i q_i^2 \int \overline{\kappa}^2(x) e^{-q_i u(x)} dx + \frac{1}{2} \int \epsilon ( \nabla u )^2 dx \]" src="form_49.png">
<p>
 for the NPBE and <p class="formulaDsp">
<img class="formulaDsp" alt="\[ G = \frac{1}{2} \int \overline{\kappa}^2(x) u^2(x) dx + \frac{1}{2} \int \epsilon ( \nabla u )^2 dx \]" src="form_50.png">
<p>
 for the LPBE. Here <img class="formulaInl" alt="$i$" src="form_23.png"> denotes the counterion species, <img class="formulaInl" alt="$I_s$" src="form_42.png"> is the bulk ionic strength, <img class="formulaInl" alt="$\overline{\kappa}^2(x)$" src="form_51.png"> is the modified Debye-Huckel parameter, <img class="formulaInl" alt="$c_i$" src="form_52.png"> is the concentration of species <img class="formulaInl" alt="$i$" src="form_23.png">, <img class="formulaInl" alt="$q_i$" src="form_21.png"> is the charge of species <img class="formulaInl" alt="$i$" src="form_23.png">, <img class="formulaInl" alt="$\epsilon$" src="form_53.png"> is the dielectric function, and <img class="formulaInl" alt="$u(x)$" src="form_54.png"> is the dimensionless electrostatic potential. The energy is scaled to units of <img class="formulaInl" alt="$k_b T$" src="form_55.png">.<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>color</em>&nbsp;</td><td>Partition restriction for energy evaluation, only used if non-negative </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The "mobile charge" and "polarization" contributions to the electrostatic energy in units of <img class="formulaInl" alt="$k_B T$" src="form_45.png">. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>color</em>&nbsp;</td><td>
The Vfetk object Partition restriction for energy calculation; if non-negative, energy calculation is restricted to the specified partition (indexed by simplex and atom colors </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g79f12393399e3ba28244d96dbd0bca4e"></a><!-- doxytag: member="vfetk.h::Vfetk_dtor" ref="g79f12393399e3ba28244d96dbd0bca4e" args="(Vfetk **thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_dtor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> **&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Object destructor. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
Pointer to memory location of Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gc300393d5c7bdda4b66389a24127d138"></a><!-- doxytag: member="vfetk.h::Vfetk_dtor2" ref="gc300393d5c7bdda4b66389a24127d138" args="(Vfetk *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_dtor2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
FORTRAN stub object destructor. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
Pointer to Vfetk object to be destroyed </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g2f59ed59d82530c900326b5aa6f101cd"></a><!-- doxytag: member="vfetk.h::Vfetk_dumpLocalVar" ref="g2f59ed59d82530c900326b5aa6f101cd" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_dumpLocalVar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Debugging routine to print out local variables used by PDE object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000024">Bug:</a></b></dt><dd>This function is not thread-safe </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="g8d59079781d2ee65d5073de3b63c530a"></a><!-- doxytag: member="vfetk.h::Vfetk_energy" ref="g8d59079781d2ee65d5073de3b63c530a" args="(Vfetk *thee, int color, int nonlin)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Vfetk_energy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>color</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nonlin</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the total electrostatic energy. 
<p>
Using the solution at the finest mesh level, get the electrostatic energy using the free energy functional for the Poisson-Boltzmann equation without removing any self-interaction terms (i.e., removing the reference state of isolated charges present in an infinite dielectric continuum with the same relative permittivity as the interior of the protein) and return the result in units of <img class="formulaInl" alt="$k_B T$" src="form_45.png">. The argument color allows the user to control the partition on which this energy is calculated; if (color == -1) no restrictions are used. The solution is obtained from the finest level of the passed AM object, but atomic data from the Vfetk object is used to calculate the energy.<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Total electrostatic energy in units of <img class="formulaInl" alt="$k_B T$" src="form_45.png">. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>color</em>&nbsp;</td><td>
THe Vfetk object </td></tr>
<tr><td valign="top"><em>nonlin</em>&nbsp;</td><td>
Partition restriction for energy calculation; if non-negative, energy calculation is restricted to the specified partition (indexed by simplex and atom colors If 1, the NPBE energy functional is used; otherwise, the LPBE energy functional is used. If -2, SMPBE is used. </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g130f353b0f7c1c432f9e208a43e645b1"></a><!-- doxytag: member="vfetk.h::Vfetk_externalUpdateFunction" ref="g130f353b0f7c1c432f9e208a43e645b1" args="(SS **simps, int num)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_externalUpdateFunction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SS **&nbsp;</td>
          <td class="mdname" nowrap> <em>simps</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>num</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
External hook to simplex subdivision routines in Gem. Called each time a simplex is subdivided (we use it to update the charge-simplex map). 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000023">Bug:</a></b></dt><dd>This function is not thread-safe. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>num</em>&nbsp;</td><td>
List of parent (simps[0]) and children (remainder) simplices Number of simplices in list </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gc16966273dd20c0a4eb7e3ef7f2f0d84"></a><!-- doxytag: member="vfetk.h::Vfetk_fillArray" ref="gc16966273dd20c0a4eb7e3ef7f2f0d84" args="(Vfetk *thee, Bvec *vec, Vdata_Type type)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Vfetk_fillArray           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>Bvec *&nbsp;</td>
          <td class="mdname" nowrap> <em>vec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__Vhal.html#gdfc214425db779e6548c11fab04ab043">Vdata_Type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fill an array with the specified data. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000025">Bug:</a></b></dt><dd>Several values of type are not implemented </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>vec</em>&nbsp;</td><td>
The Vfetk object with the data </td></tr>
<tr><td valign="top"><em>type</em>&nbsp;</td><td>
The vector to hold the data THe type of data to write </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ge473241047881ecd91d72cba8b037999"></a><!-- doxytag: member="vfetk.h::Vfetk_genCube" ref="ge473241047881ecd91d72cba8b037999" args="(Vfetk *thee, double center[3], double length[3], Vfetk_MeshLoad meshType)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Vrc_Codes Vfetk_genCube           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>center</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__Vfetk.html#g0ae7e4598a4dfa736d291a33d341c808">Vfetk_MeshLoad</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>meshType</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Construct a rectangular mesh (in the current Vfetk object). 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
Vfetk object </td></tr>
<tr><td valign="top"><em>length</em>&nbsp;</td><td>
Center for mesh </td></tr>
<tr><td valign="top"><em>meshType</em>&nbsp;</td><td>
Mesh lengths Mesh boundary conditions </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gf9e2cfba465b60e1cbd0fa228f969596"></a><!-- doxytag: member="vfetk.h::Vfetk_getAM" ref="gf9e2cfba465b60e1cbd0fa228f969596" args="(Vfetk *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AM* Vfetk_getAM           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a pointer to the AM (algebra manager) object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the AM (algebra manager) object </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
The Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g64e3f8c9df71e989da14be147d378625"></a><!-- doxytag: member="vfetk.h::Vfetk_getAtomColor" ref="g64e3f8c9df71e989da14be147d378625" args="(Vfetk *thee, int iatom)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Vfetk_getAtomColor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iatom</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the partition information for a particular atom. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>Friend function of Vatom </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iatom</em>&nbsp;</td><td>Valist atom ID </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Partition ID </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>iatom</em>&nbsp;</td><td>
The Vfetk object Valist atom index </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ge996913edc49d3be58cfad38cf2ead4d"></a><!-- doxytag: member="vfetk.h::Vfetk_getGem" ref="ge996913edc49d3be58cfad38cf2ead4d" args="(Vfetk *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Gem* Vfetk_getGem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a pointer to the Gem (grid manager) object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the Gem (grid manager) object </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g414150bb3abf21e2d461b7fd596befa9"></a><!-- doxytag: member="vfetk.h::Vfetk_getSolution" ref="g414150bb3abf21e2d461b7fd596befa9" args="(Vfetk *thee, int *length)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double* Vfetk_getSolution           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create an array containing the solution (electrostatic potential in units of <img class="formulaInl" alt="$k_B T/e$" src="form_48.png">) at the finest mesh level. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Michael Holst </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>The user is responsible for destroying the newly created array </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Newly created array of length "length" (see above); the user is responsible for destruction </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>length</em>&nbsp;</td><td>
Vfetk object with solution Ste to length of the newly created solution array </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ge16c17016c3f527e1639f0e2e2ece7f3"></a><!-- doxytag: member="vfetk.h::Vfetk_getVcsm" ref="ge16c17016c3f527e1639f0e2e2ece7f3" args="(Vfetk *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structsVcsm.html">Vcsm</a>* Vfetk_getVcsm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a pointer to the Vcsm (charge-simplex map) object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the Vcsm (charge-simplex map) object </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
The Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g1231ccdd3888cc5f45ade93470c4cd1b"></a><!-- doxytag: member="vfetk.h::Vfetk_getVpbe" ref="g1231ccdd3888cc5f45ade93470c4cd1b" args="(Vfetk *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structsVpbe.html">Vpbe</a>* Vfetk_getVpbe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a pointer to the Vpbe (PBE manager) object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Pointer to the Vpbe (PBE manager) object </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
The Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gd6be15a2e00968d685a09131436bcc10"></a><!-- doxytag: member="vfetk.h::Vfetk_loadGem" ref="gd6be15a2e00968d685a09131436bcc10" args="(Vfetk *thee, Gem *gm)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Vrc_Codes Vfetk_loadGem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>Gem *&nbsp;</td>
          <td class="mdname" nowrap> <em>gm</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Load a Gem geometry manager object into Vfetk. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
Destination </td></tr>
<tr><td valign="top"><em>gm</em>&nbsp;</td><td>
Geometry manager source </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gfd508383dd1b2fbcacad0aee73373b57"></a><!-- doxytag: member="vfetk.h::Vfetk_loadMesh" ref="gfd508383dd1b2fbcacad0aee73373b57" args="(Vfetk *thee, double center[3], double length[3], Vfetk_MeshLoad meshType, Vio *sock)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Vrc_Codes Vfetk_loadMesh           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>center</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__Vfetk.html#g0ae7e4598a4dfa736d291a33d341c808">Vfetk_MeshLoad</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>meshType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>Vio *&nbsp;</td>
          <td class="mdname" nowrap> <em>sock</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Loads a mesh into the Vfetk (and associated) object(s). 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>center</em>&nbsp;</td><td>
Vfetk object to load into </td></tr>
<tr><td valign="top"><em>length</em>&nbsp;</td><td>
Center for mesh (if constructed) </td></tr>
<tr><td valign="top"><em>meshType</em>&nbsp;</td><td>
Mesh lengths (if constructed) </td></tr>
<tr><td valign="top"><em>sock</em>&nbsp;</td><td>
Type of mesh to load Socket for external mesh data (NULL otherwise) </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g1317d1cbf17e934f5b88f9238bf763f6"></a><!-- doxytag: member="vfetk.h::Vfetk_memChk" ref="g1317d1cbf17e934f5b88f9238bf763f6" args="(Vfetk *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned long int Vfetk_memChk           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the memory used by this structure (and its contents) in bytes. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>The memory used by this structure and its contents in bytes </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
THe Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g877160adf876489f6493322cf34831d9"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_bisectEdge" ref="g877160adf876489f6493322cf34831d9" args="(int dim, int dimII, int edgeType, int chart[], double vx[][VAPBS_DIM])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_bisectEdge           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dimII</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>edgeType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>vx</em>[][VAPBS_DIM]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Define the way manifold edges are bisected. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dimII</em>&nbsp;</td><td>
Intrinsic dimension of manifold </td></tr>
<tr><td valign="top"><em>edgeType</em>&nbsp;</td><td>
Embedding dimension of manifold </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Type of edge being refined </td></tr>
<tr><td valign="top"><em>vx</em>&nbsp;</td><td>
Chart for edge vertices, used here as accessibility bitfields Edge vertex coordindates </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g4bb67f5500dd28dcd582d920b50d0b4e"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_ctor" ref="g4bb67f5500dd28dcd582d920b50d0b4e" args="(Vfetk *fetk)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">PDE* Vfetk_PDE_ctor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fetk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructs the FEtk PDE object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Newly-allocated PDE object </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000010">Bug:</a></b></dt><dd>Not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fetk</em>&nbsp;</td><td>
The Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g40b301931083038af40312b49b167794"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_ctor2" ref="g40b301931083038af40312b49b167794" args="(PDE *thee, Vfetk *fetk)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Vfetk_PDE_ctor2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>fetk</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Intializes the FEtk PDE object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker (with code by Mike Holst) </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000011">Bug:</a></b></dt><dd>Not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fetk</em>&nbsp;</td><td>
The newly-allocated PDE object The parent Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gd8b11d6436d7ea407c94ac79eb1f9e99"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_delta" ref="gd8b11d6436d7ea407c94ac79eb1f9e99" args="(PDE *thee, int type, int chart, double txq[], void *user, double F[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_delta           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>txq</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Evaluate a (discretized) delta function source term at the given point. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000018">Bug:</a></b></dt><dd>This function is not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>type</em>&nbsp;</td><td>
PDE object </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Vertex type </td></tr>
<tr><td valign="top"><em>txq</em>&nbsp;</td><td>
Chart for point coordinates </td></tr>
<tr><td valign="top"><em>user</em>&nbsp;</td><td>
Point coordinates </td></tr>
<tr><td valign="top"><em>F</em>&nbsp;</td><td>
Vertex object pointer Set to delta function value </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g58889daff822d088b8286402228eb8e2"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_DFu_wv" ref="g58889daff822d088b8286402228eb8e2" args="(PDE *thee, int key, double W[], double dW[][VAPBS_DIM], double V[], double dV[][VAPBS_DIM])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Vfetk_PDE_DFu_wv           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>W</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>dW</em>[][VAPBS_DIM], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>V</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>dV</em>[][VAPBS_DIM]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is the linearization of the weak form of the PBE; e.g., for use in a Newton iteration. This is the functional linearization of the strong form integrated with a test function to give: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_\Omega \left[ \epsilon \nabla w \cdot \nabla v + b'(u) w v - f v \right] dx \]" src="form_62.png">
<p>
 where <img class="formulaInl" alt="$b'(u)$" src="form_63.png"> denotes the functional derivation of the mobile ion term. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Integrand value </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000017">Bug:</a></b></dt><dd>This function is not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>key</em>&nbsp;</td><td>
The PDE object </td></tr>
<tr><td valign="top"><em>W</em>&nbsp;</td><td>
Integrand to evaluate (0 = interior weak form, 1 = boundary weak form) </td></tr>
<tr><td valign="top"><em>dW</em>&nbsp;</td><td>
Trial function value at current point </td></tr>
<tr><td valign="top"><em>V</em>&nbsp;</td><td>
Trial function gradient at current point </td></tr>
<tr><td valign="top"><em>dV</em>&nbsp;</td><td>
Test function value at current point Test function gradient </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gf53be91ac6774829c8f377c15dda8ea5"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_dtor" ref="gf53be91ac6774829c8f377c15dda8ea5" args="(PDE **thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_dtor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE **&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destroys FEtk PDE object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
Pointer to PDE object memory </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gea58e1b29973b503b24ef85c08320253"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_dtor2" ref="gea58e1b29973b503b24ef85c08320253" args="(PDE *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_dtor2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
FORTRAN stub: destroys FEtk PDE object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
PDE object memory </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g6ab828dbe466030949f3332a6370a22a"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_Fu" ref="g6ab828dbe466030949f3332a6370a22a" args="(PDE *thee, int key, double F[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_Fu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Evaluate strong form of PBE. For interior points, this is: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ -\nabla \cdot \epsilon \nabla u + b(u) - f \]" src="form_56.png">
<p>
 where <img class="formulaInl" alt="$b(u)$" src="form_57.png"> is the (possibly nonlinear) mobile ion term and <img class="formulaInl" alt="$f$" src="form_58.png"> is the source charge distribution term (for PBE) or the induced surface charge distribution (for RPBE). For an interior-boundary (simplex face) point, this is: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ [\epsilon(x) \nabla u(x) \cdot n(x)]_{x=0^+} - [\epsilon(x) \nabla u(x) \cdot n(x)]_{x=0^-} \]" src="form_59.png">
<p>
 where <img class="formulaInl" alt="$n(x)$" src="form_60.png"> is the normal to the simplex face and the term represents the jump in dielectric displacement across the face. There is no outer-boundary contribution for this problem. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000015">Bug:</a></b></dt><dd>This function is not thread-safe <p>
This function is not implemented (sets error to zero) </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>key</em>&nbsp;</td><td>
The PDE object </td></tr>
<tr><td valign="top"><em>F</em>&nbsp;</td><td>
Type of point (0 = interior, 1 = boundary, 2 = interior boundary Set to value of residual </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gd8bfaaca31087ca5c98663f1a9839bcc"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_Fu_v" ref="gd8bfaaca31087ca5c98663f1a9839bcc" args="(PDE *thee, int key, double V[], double dV[][VAPBS_DIM])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Vfetk_PDE_Fu_v           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>V</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>dV</em>[][VAPBS_DIM]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is the weak form of the PBE; i.e. the strong form integrated with a test function to give: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_\Omega \left[ \epsilon \nabla u \cdot \nabla v + b(u) v - f v \right] dx \]" src="form_61.png">
<p>
 where <img class="formulaInl" alt="$b(u)$" src="form_57.png"> denotes the mobile ion term. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Integrand value </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000016">Bug:</a></b></dt><dd>This function is not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>key</em>&nbsp;</td><td>
The PDE object </td></tr>
<tr><td valign="top"><em>V</em>&nbsp;</td><td>
Integrand to evaluate (0 = interior weak form, 1 = boundary weak form </td></tr>
<tr><td valign="top"><em>dV</em>&nbsp;</td><td>
Test function at current point Test function derivative at current point </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g850c1f0593b2b3ba8ad2795b5642d340"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_initAssemble" ref="g850c1f0593b2b3ba8ad2795b5642d340" args="(PDE *thee, int ip[], double rp[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_initAssemble           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ip</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>rp</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Do once-per-assembly initialization. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>ip</em>&nbsp;</td><td>
PDE object </td></tr>
<tr><td valign="top"><em>rp</em>&nbsp;</td><td>
Integer parameter array (not used) Double parameter array (not used) </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gecb946cbd53bd9aeddd67c1e4494b6fa"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_initElement" ref="gecb946cbd53bd9aeddd67c1e4494b6fa" args="(PDE *thee, int elementType, int chart, double tvx[][VAPBS_DIM], void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_initElement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>elementType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>tvx</em>[][VAPBS_DIM], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Do once-per-element initialization. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Jump term is not implemented </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000012">Bug:</a></b></dt><dd>This function is not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>elementType</em>&nbsp;</td><td>
PDE object </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Material type (not used) </td></tr>
<tr><td valign="top"><em>tvx</em>&nbsp;</td><td>
Chart in which the vertex coordinates are provided, used here as a bitfield to store molecular accessibility </td></tr>
<tr><td valign="top"><em>data</em>&nbsp;</td><td>
Vertex coordinates Simplex pointer (hack) </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g92f682b4b349b1236be7306b8091a6f0"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_initFace" ref="g92f682b4b349b1236be7306b8091a6f0" args="(PDE *thee, int faceType, int chart, double tnvec[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_initFace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>faceType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>tnvec</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Do once-per-face initialization. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000013">Bug:</a></b></dt><dd>This function is not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>faceType</em>&nbsp;</td><td>
THe PDE object </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Simplex face type (interior or various boundary types) </td></tr>
<tr><td valign="top"><em>tnvec</em>&nbsp;</td><td>
Chart in which the vertex coordinates are provided, used here as a bitfield for molecular accessibility Coordinates of outward normal vector for face </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gb2c9190ba012844d51836146e4c0a6c1"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_initPoint" ref="gb2c9190ba012844d51836146e4c0a6c1" args="(PDE *thee, int pointType, int chart, double txq[], double tU[], double tdU[][VAPBS_DIM])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_initPoint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pointType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>txq</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>tU</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>tdU</em>[][VAPBS_DIM]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Do once-per-point initialization. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000014">Bug:</a></b></dt><dd>This function is not thread-safe <p>
This function uses pre-defined boudnary definitions for the molecular surface. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>pointType</em>&nbsp;</td><td>
The PDE object </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
The type of point -- interior or various faces </td></tr>
<tr><td valign="top"><em>txq</em>&nbsp;</td><td>
The chart in which the point coordinates are provided, used here as bitfield for molecular accessibility </td></tr>
<tr><td valign="top"><em>tU</em>&nbsp;</td><td>
Point coordinates </td></tr>
<tr><td valign="top"><em>tdU</em>&nbsp;</td><td>
Solution value at point Solution derivative at point </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gcd6aede0ecf4ee5b7cd103a68a28aeee"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_Ju" ref="gcd6aede0ecf4ee5b7cd103a68a28aeee" args="(PDE *thee, int key)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Vfetk_PDE_Ju           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>key</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Energy functional. This returns the energy (less delta function terms) in the form: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ c^{-1}/2 \int (\epsilon (\nabla u)^2 + \kappa^2 (cosh u - 1)) dx \]" src="form_64.png">
<p>
 for a 1:1 electrolyte where <img class="formulaInl" alt="$c$" src="form_65.png"> is the output from Vpbe_getZmagic. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>Energy value (in kT) </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000022">Bug:</a></b></dt><dd>This function is not thread-safe. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>key</em>&nbsp;</td><td>
The PDE object What to evluate: interior (0) or boundary (1)? </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gab7c03cc5568407794999c0f617ab889"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_mapBoundary" ref="gab7c03cc5568407794999c0f617ab889" args="(int dim, int dimII, int vertexType, int chart, double vx[VAPBS_DIM])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_mapBoundary           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dimII</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>vertexType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>vx</em>[VAPBS_DIM]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Map a boundary point to some pre-defined shape. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker and Mike Holst </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe and is a no-op </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dimII</em>&nbsp;</td><td>
Intrinsic dimension of manifold </td></tr>
<tr><td valign="top"><em>vertexType</em>&nbsp;</td><td>
Embedding dimension of manifold </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Type of vertex </td></tr>
<tr><td valign="top"><em>vx</em>&nbsp;</td><td>
Chart for vertex coordinates Vertex coordinates </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gc35880a0b1dcab29fb0eb12aeae116b2"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_markSimplex" ref="gc35880a0b1dcab29fb0eb12aeae116b2" args="(int dim, int dimII, int simplexType, int faceType[VAPBS_NVS], int vertexType[VAPBS_NVS], int chart[], double vx[][VAPBS_DIM], void *simplex)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Vfetk_PDE_markSimplex           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dimII</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>simplexType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>faceType</em>[VAPBS_NVS], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>vertexType</em>[VAPBS_NVS], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>vx</em>[][VAPBS_DIM], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>simplex</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
User-defined error estimator -- in our case, a geometry-based refinement method; forcing simplex refinement at the dielectric boundary and (for non-regularized PBE) the charges. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if mark simplex for refinement, 0 otherwise </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000021">Bug:</a></b></dt><dd>This function is not thread-safe </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dimII</em>&nbsp;</td><td>
Intrinsic manifold dimension </td></tr>
<tr><td valign="top"><em>simplexType</em>&nbsp;</td><td>
Embedding manifold dimension </td></tr>
<tr><td valign="top"><em>faceType</em>&nbsp;</td><td>
Type of simplex being refined </td></tr>
<tr><td valign="top"><em>vertexType</em>&nbsp;</td><td>
Types of faces in simplex </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Types of vertices in simplex </td></tr>
<tr><td valign="top"><em>vx</em>&nbsp;</td><td>
Charts for vertex coordinates </td></tr>
<tr><td valign="top"><em>simplex</em>&nbsp;</td><td>
Vertex coordinates Simplex pointer </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g0e48a1a433ae34229a1cf5157260eb8c"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_oneChart" ref="g0e48a1a433ae34229a1cf5157260eb8c" args="(int dim, int dimII, int objType, int chart[], double vx[][VAPBS_DIM], int dimV)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_oneChart           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dimII</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>objType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>vx</em>[][VAPBS_DIM], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dimV</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unify the chart for different coordinate systems -- a no-op for us. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>Thread-safe; a no-op </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dimII</em>&nbsp;</td><td>
Intrinsic manifold dimension </td></tr>
<tr><td valign="top"><em>objType</em>&nbsp;</td><td>
Embedding manifold dimension </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
??? </td></tr>
<tr><td valign="top"><em>vx</em>&nbsp;</td><td>
Charts of vertices' coordinates </td></tr>
<tr><td valign="top"><em>dimV</em>&nbsp;</td><td>
Vertices' coordinates Number of vertices </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gb42e012aef0ff3f23862dacdbaf86f0a"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_simplexBasisForm" ref="gb42e012aef0ff3f23862dacdbaf86f0a" args="(int key, int dim, int comp, int pdkey, double xq[], double basis[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_simplexBasisForm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>comp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pdkey</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>xq</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>basis</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Evaluate the bases for the trial or test space, for a particular component of the system, at all quadrature points on the master simplex element. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Mike Holst </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
Basis type to evaluate (0 = trial, 1 = test, 2 = trialB, 3 = testB) </td></tr>
<tr><td valign="top"><em>comp</em>&nbsp;</td><td>
Spatial dimension Which component of elliptic system to produce basis for </td></tr>
<tr><td valign="top"><em>xq</em>&nbsp;</td><td>
Basis partial differential equation evaluation key: <ul>
<li>0 = evaluate basis(x,y,z) </li>
<li>1 = evaluate basis_x(x,y,z) </li>
<li>2 = evaluate basis_y(x,y,z) </li>
<li>3 = evaluate basis_z(x,y,z) </li>
<li>4 = evaluate basis_xx(x,y,z) </li>
<li>5 = evaluate basis_yy(x,y,z) </li>
<li>6 = evaluate basis_zz(x,y,z) </li>
<li>7 = etc... </li>
</ul>
</td></tr>
<tr><td valign="top"><em>basis</em>&nbsp;</td><td>
Set to quad pt coordinate Set to all basis functions evaluated at all quadrature pts </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g0ba7af67b39b140e8150e5699eb2ad31"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_simplexBasisInit" ref="g0ba7af67b39b140e8150e5699eb2ad31" args="(int key, int dim, int comp, int *ndof, int dof[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Vfetk_PDE_simplexBasisInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>comp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>ndof</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dof</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize the bases for the trial or the test space, for a particular component of the system, at all quadrature points on the master simplex element. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Mike Holst </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd><div class="fragment"><pre class="fragment"> *   The basis ordering is important.  For a fixed quadrature
 *   point iq, you must follow the following ordering in p[iq][],
 *   based on how you specify the degrees of freedom in dof[]:
 *   
 *   &lt;v_0 vDF_0&gt;,      &lt;v_1 vDF_0&gt;,      ..., &lt;v_{nv} vDF_0&gt;
 *   &lt;v_0 vDF_1&gt;,      &lt;v_1 vDF_1&gt;,      ..., &lt;v_{nv} vDF_1&gt;
 *                           ...
 *   &lt;v_0 vDF_{nvDF}&gt;, &lt;v_0 vDF_{nvDF}&gt;, ..., &lt;v_{nv} vDF_{nvDF}&gt;
 *   
 *   &lt;e_0 eDF_0&gt;,      &lt;e_1 eDF_0&gt;,      ..., &lt;e_{ne} eDF_0&gt;
 *   &lt;e_0 eDF_1&gt;,      &lt;e_1 eDF_1&gt;,      ..., &lt;e_{ne} eDF_1&gt;
 *                           ...
 *   &lt;e_0 eDF_{neDF}&gt;, &lt;e_1 eDF_{neDF}&gt;, ..., &lt;e_{ne} eDF_{neDF}&gt;
 *
 *   &lt;f_0 fDF_0&gt;,      &lt;f_1 fDF_0&gt;,      ..., &lt;f_{nf} fDF_0&gt;
 *   &lt;f_0 fDF_1&gt;,      &lt;f_1 fDF_1&gt;,      ..., &lt;f_{nf} fDF_1&gt;
 *                           ...
 *   &lt;f_0 fDF_{nfDF}&gt;, &lt;f_1 fDF_{nfDF}&gt;, ..., &lt;f_{nf} fDF_{nfDF}&gt;
 *
 *   &lt;s_0 sDF_0&gt;,      &lt;s_1 sDF_0&gt;,      ..., &lt;s_{ns} sDF_0&gt;
 *   &lt;s_0 sDF_1&gt;,      &lt;s_1 sDF_1&gt;,      ..., &lt;s_{ns} sDF_1&gt;
 *                           ...
 *   &lt;s_0 sDF_{nsDF}&gt;, &lt;s_1 sDF_{nsDF}&gt;, ..., &lt;s_{ns} sDF_{nsDF}&gt;
 *
 *   For example, linear elements in R^3, with one degree of freedom at each *
 *   vertex, would use the following ordering: 
 *
 *     &lt;v_0 vDF_0&gt;, &lt;v_1 vDF_0&gt;, &lt;v_2 vDF_0&gt;, &lt;v_3 vDF_0&gt; 
 *
 *   Quadratic elements in R^2, with one degree of freedom at each vertex and
 *   edge, would use the following ordering: 
 * 
 *     &lt;v_0 vDF_0&gt;, &lt;v_1 vDF_0&gt;, &lt;v_2 vDF_0&gt; 
 *     &lt;e_0 eDF_0&gt;, &lt;e_1 eDF_0&gt;, &lt;e_2 eDF_0&gt; 
 *
 *   You can use different trial and test spaces for each component of the
 *   elliptic system, thereby allowing for the use of Petrov-Galerkin methods.
 *   You MUST then tag the bilinear form symmetry entries as nonsymmetric in
 *   your PDE constructor to reflect that DF(u)(w,v) will be different from
 *   DF(u)(v,w), even if your form acts symmetrically when the same basis is
 *   used for w and v.
 * 
 *   You can also use different trial spaces for each component of the elliptic
 *   system, and different test spaces for each component of the elliptic
 *   system.  This allows you to e.g.  use a basis which is vertex-based for 
 *   one component, and a basis which is edge-based for another.  This is
 *   useful in fluid mechanics, eletromagnetics, or simply to play around with
 *   different elements.  
 *   
 *   This function is called by MC to build new master elements whenever it
 *   reads in a new mesh.  Therefore, this function does not have to be all
 *   that fast, and e.g.  could involve symbolic computation.
 *   </pre></div> </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>dim</em>&nbsp;</td><td>
Basis type to evaluate (0 = trial, 1 = test, 2 = trialB, 3 = testB) </td></tr>
<tr><td valign="top"><em>comp</em>&nbsp;</td><td>
Spatial dimension </td></tr>
<tr><td valign="top"><em>ndof</em>&nbsp;</td><td>
Which component of elliptic system to produce basis for? </td></tr>
<tr><td valign="top"><em>dof</em>&nbsp;</td><td>
Set to the number of degrees of freedom Set to degree of freedom per v/e/f/s </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gc37aeabeafd642e7a67b0654497ce2ab"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_u_D" ref="gc37aeabeafd642e7a67b0654497ce2ab" args="(PDE *thee, int type, int chart, double txq[], double F[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_u_D           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>txq</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Evaluate the Dirichlet boundary condition at the given point. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000019">Bug:</a></b></dt><dd>This function is hard-coded to call only multiple-sphere Debye-H&uuml; functions. <p>
This function is not thread-safe. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>type</em>&nbsp;</td><td>
PDE object </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Vertex boundary type </td></tr>
<tr><td valign="top"><em>txq</em>&nbsp;</td><td>
Chart for point coordinates </td></tr>
<tr><td valign="top"><em>F</em>&nbsp;</td><td>
Point coordinates Set to boundary values </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g0d6f246e3a44d57b2907972efe97bb14"></a><!-- doxytag: member="vfetk.h::Vfetk_PDE_u_T" ref="g0d6f246e3a44d57b2907972efe97bb14" args="(PDE *thee, int type, int chart, double txq[], double F[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_PDE_u_T           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PDE *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>chart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>txq</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Evaluate the "true solution" at the given point for comparison with the numerical solution. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This function only returns zero. </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000020">Bug:</a></b></dt><dd>This function is not thread-safe. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>type</em>&nbsp;</td><td>
PDE object </td></tr>
<tr><td valign="top"><em>chart</em>&nbsp;</td><td>
Point type </td></tr>
<tr><td valign="top"><em>txq</em>&nbsp;</td><td>
Chart for point coordinates </td></tr>
<tr><td valign="top"><em>F</em>&nbsp;</td><td>
Point coordinates Set to value at point </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gdfc571213f31e96d961f0828fa8fcda7"></a><!-- doxytag: member="vfetk.h::Vfetk_qfEnergy" ref="gdfc571213f31e96d961f0828fa8fcda7" args="(Vfetk *thee, int color)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double Vfetk_qfEnergy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>color</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the "fixed charge" contribution to the electrostatic energy. 
<p>
Using the solution at the finest mesh level, get the electrostatic energy due to the interaction of the fixed charges with the potential: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ G = \sum_i q_i u(r_i) \]" src="form_10.png">
<p>
 and return the result in units of <img class="formulaInl" alt="$k_B T$" src="form_45.png">. Clearly, no self-interaction terms are removed. A factor a 1/2 has to be included to convert this to a real energy.<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>color</em>&nbsp;</td><td>Partition restriction for energy evaluation, only used if non-negative </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The fixed charge electrostatic energy in units of <img class="formulaInl" alt="$k_B T$" src="form_45.png">. </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>color</em>&nbsp;</td><td>
The Vfetk object Partition restriction for energy evaluation, only used if non-negative </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gcc1cb65fc774540f00795cfde20d9532"></a><!-- doxytag: member="vfetk.h::Vfetk_readMesh" ref="gcc1cb65fc774540f00795cfde20d9532" args="(Vfetk *thee, int skey, Vio *sock)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_readMesh           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>skey</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>Vio *&nbsp;</td>
          <td class="mdname" nowrap> <em>sock</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read in mesh and initialize associated internal structures. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd></dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__Vfetk.html#ge473241047881ecd91d72cba8b037999">Vfetk_genCube</a> </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>skey</em>&nbsp;</td><td>
THe Vfetk object </td></tr>
<tr><td valign="top"><em>sock</em>&nbsp;</td><td>
The sock format key (0 = MCSF simplex format) Socket object ready for reading </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g4be8c4c7a641a5fa2c5f8e2ae02d00fb"></a><!-- doxytag: member="vfetk.h::Vfetk_setAtomColors" ref="g4be8c4c7a641a5fa2c5f8e2ae02d00fb" args="(Vfetk *thee)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_setAtomColors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>thee</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Transfer color (partition ID) information frmo a partitioned mesh to the atoms. 
<p>
Transfer color information from partitioned mesh to the atoms. In the case that a charge is shared between two partitions, the partition color of the first simplex is selected. Due to the arbitrary nature of this selection, THIS METHOD SHOULD ONLY BE USED IMMEDIATELY AFTER PARTITIONING!!! <dl compact><dt><b>Warning:</b></dt><dd>This function should only be used immediately after mesh partitioning</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>This is a friend function of Vcsm </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>thee</em>&nbsp;</td><td>
THe Vfetk object </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="gf64eaf3618d20138562a8cc5ba595f28"></a><!-- doxytag: member="vfetk.h::Vfetk_setParameters" ref="gf64eaf3618d20138562a8cc5ba595f28" args="(Vfetk *thee, PBEparm *pbeparm, FEMparm *feparm)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void Vfetk_setParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structsPBEparm.html">PBEparm</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pbeparm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structsFEMparm.html">FEMparm</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>feparm</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the parameter objects. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>pbeparm</em>&nbsp;</td><td>
The Vfetk object </td></tr>
<tr><td valign="top"><em>feparm</em>&nbsp;</td><td>
Parameters for solution of the PBE FEM-speecific solution parameters </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="g40b0e35447fa6d193bd2fdf2f4a0a86d"></a><!-- doxytag: member="vfetk.h::Vfetk_write" ref="g40b0e35447fa6d193bd2fdf2f4a0a86d" args="(Vfetk *thee, const char *iodev, const char *iofmt, const char *thost, const char *fname, Bvec *vec, Vdata_Format format)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Vfetk_write           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsVfetk.html">Vfetk</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>thee</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>iodev</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>iofmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>thost</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>Bvec *&nbsp;</td>
          <td class="mdname" nowrap> <em>vec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="group__Vhal.html#gc4f593940585c6a15518f6a7e60ac255">Vdata_Format</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write out data. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Nathan Baker </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>thee</em>&nbsp;</td><td>Vfetk object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vec</em>&nbsp;</td><td>FEtk Bvec vector to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>format</em>&nbsp;</td><td>Format for data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iodev</em>&nbsp;</td><td>Output device type (FILE/BUFF/UNIX/INET) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iofmt</em>&nbsp;</td><td>Output device format (ASCII/XDR) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>thost</em>&nbsp;</td><td>Output hostname (for sockets) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fname</em>&nbsp;</td><td>Output FILE/BUFF/UNIX/INET name </td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>This function is thread-safe </dd></dl>
<dl compact><dt><b><a class="el" href="bug.html#_bug000026">Bug:</a></b></dt><dd>Some values of format are not implemented </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if successful, 0 otherwise </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>iodev</em>&nbsp;</td><td>
The Vfetk object </td></tr>
<tr><td valign="top"><em>iofmt</em>&nbsp;</td><td>
Output device type (FILE = file, BUFF = buffer, UNIX = unix pipe, INET = network socket) </td></tr>
<tr><td valign="top"><em>thost</em>&nbsp;</td><td>
Output device format (ASCII = ascii/plaintext, XDR = xdr) </td></tr>
<tr><td valign="top"><em>fname</em>&nbsp;</td><td>
Output hostname for sockets </td></tr>
<tr><td valign="top"><em>vec</em>&nbsp;</td><td>
Output filename for other </td></tr>
<tr><td valign="top"><em>format</em>&nbsp;</td><td>
Data vector Data format </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sun Mar 30 16:17:41 2008 for APBS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6 </small></address>
</body>
</html>
