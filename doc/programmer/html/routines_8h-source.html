<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>APBS: routines.h Source File</title>
<link href="apbs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>routines.h</h1><a href="routines_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00071 <span class="preprocessor">#ifndef _APBSROUTINES_H_</span>
00072 <span class="preprocessor"></span><span class="preprocessor">#define _APBSROUTINES_H_</span>
00073 <span class="preprocessor"></span>
00074 <span class="preprocessor">#include "apbscfg.h"</span>
00075 <span class="preprocessor">#include "<a class="code" href="apbs_8h.html">apbs/apbs.h</a>"</span>  
00076 <span class="preprocessor">#include "<a class="code" href="nosh_8h.html">apbs/nosh.h</a>"</span>  
00077 <span class="preprocessor">#include "<a class="code" href="mgparm_8h.html">apbs/mgparm.h</a>"</span>  
00078 <span class="preprocessor">#include "<a class="code" href="pbeparm_8h.html">apbs/pbeparm.h</a>"</span>  
00079 <span class="preprocessor">#include "<a class="code" href="femparm_8h.html">apbs/femparm.h</a>"</span>  
00080 <span class="preprocessor">#include "<a class="code" href="vparam_8h.html">apbs/vparam.h</a>"</span>  
00081 
00082 
<a name="l00086"></a><a class="code" href="group__Frontend.html#a44">00086</a> <span class="preprocessor">#define APBSRC 13</span>
00087 <span class="preprocessor"></span>
<a name="l00092"></a><a class="code" href="structAtomForce.html">00092</a> <span class="keyword">struct </span><a class="code" href="structAtomForce.html">AtomForce</a> {
<a name="l00093"></a><a class="code" href="structAtomForce.html#o0">00093</a>    <span class="keywordtype">double</span> <a class="code" href="structAtomForce.html#o0">ibForce</a>[3];  
<a name="l00094"></a><a class="code" href="structAtomForce.html#o1">00094</a>    <span class="keywordtype">double</span> <a class="code" href="structAtomForce.html#o1">qfForce</a>[3];  
<a name="l00095"></a><a class="code" href="structAtomForce.html#o2">00095</a>    <span class="keywordtype">double</span> <a class="code" href="structAtomForce.html#o2">dbForce</a>[3];  
<a name="l00096"></a><a class="code" href="structAtomForce.html#o3">00096</a>    <span class="keywordtype">double</span> <a class="code" href="structAtomForce.html#o3">sasaForce</a>[3];  
<a name="l00097"></a><a class="code" href="structAtomForce.html#o4">00097</a>    <span class="keywordtype">double</span> <a class="code" href="structAtomForce.html#o4">savForce</a>[3];  
<a name="l00098"></a><a class="code" href="structAtomForce.html#o5">00098</a>    <span class="keywordtype">double</span> <a class="code" href="structAtomForce.html#o5">wcaForce</a>[3];  
00099 };
00100 
<a name="l00104"></a><a class="code" href="group__Frontend.html#a0">00104</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAtomForce.html">AtomForce</a> <a class="code" href="group__Frontend.html#a0">AtomForce</a>;
00105 
00111 <a class="code" href="structVparam.html">Vparam</a>* <a class="code" href="group__Frontend.html#a1">loadParameter</a>(
00112                                                            <a class="code" href="structsNOsh.html">NOsh</a> *nosh  
00114                                                            );
00115 
00121 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a2">loadMolecules</a>(
00122                                                    <a class="code" href="structsNOsh.html">NOsh</a> *nosh, 
00123                                                    <a class="code" href="structVparam.html">Vparam</a> *param,  
00125                                                    <a class="code" href="structsValist.html">Valist</a> *alist[NOSH_MAXMOL]  
00127                                                    );
00128 
00135 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a3">killMolecules</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsValist.html">Valist</a> *alist[NOSH_MAXMOL]);
00136 
00146 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a4">loadDielMaps</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVgrid.html">Vgrid</a> *dielXMap[NOSH_MAXMOL],
00147   <a class="code" href="structsVgrid.html">Vgrid</a> *dielYMap[NOSH_MAXMOL], <a class="code" href="structsVgrid.html">Vgrid</a> *dielZMap[NOSH_MAXMOL]);
00148 
00157 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a5">killDielMaps</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVgrid.html">Vgrid</a> *dielXMap[NOSH_MAXMOL],
00158   <a class="code" href="structsVgrid.html">Vgrid</a> *dielYMap[NOSH_MAXMOL], <a class="code" href="structsVgrid.html">Vgrid</a> *dielZMap[NOSH_MAXMOL]);
00159 
00167 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a6">loadKappaMaps</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVgrid.html">Vgrid</a> *kappa[NOSH_MAXMOL]);
00168 
00175 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a7">killKappaMaps</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVgrid.html">Vgrid</a> *kappa[NOSH_MAXMOL]);
00176 
00184 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a8">loadChargeMaps</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVgrid.html">Vgrid</a> *charge[NOSH_MAXMOL]);
00185 
00192 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a9">killChargeMaps</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVgrid.html">Vgrid</a> *charge[NOSH_MAXMOL]);
00193 
00199 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a10">printPBEPARM</a>(<a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm);
00200 
00207 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a11">printMGPARM</a>(<a class="code" href="structsMGparm.html">MGparm</a> *mgparm, <span class="keywordtype">double</span> realCenter[3]);
00208 
00214 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a12">initMG</a>(
00215                                         <span class="keywordtype">int</span> icalc,  
00216                                         <a class="code" href="structsNOsh.html">NOsh</a> *nosh,  
00217                                         <a class="code" href="structsMGparm.html">MGparm</a> *mgparm,  
00218                                         <a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm,  
00219                                         <span class="keywordtype">double</span> realCenter[3],  
00220                                         <a class="code" href="structsVpbe.html">Vpbe</a> *pbe[NOSH_MAXCALC],  
00221                                         <a class="code" href="structsValist.html">Valist</a> *alist[NOSH_MAXMOL],  
00222                                         <a class="code" href="structsVgrid.html">Vgrid</a> *dielXMap[NOSH_MAXMOL],  
00223                                         <a class="code" href="structsVgrid.html">Vgrid</a> *dielYMap[NOSH_MAXMOL],  
00224                                         <a class="code" href="structsVgrid.html">Vgrid</a> *dielZMap[NOSH_MAXMOL],  
00225                                         <a class="code" href="structsVgrid.html">Vgrid</a> *kappaMap[NOSH_MAXMOL],  
00226                                         <a class="code" href="structsVgrid.html">Vgrid</a> *chargeMap[NOSH_MAXMOL],  
00227                                         <a class="code" href="structsVpmgp.html">Vpmgp</a> *pmgp[NOSH_MAXCALC],  
00228                                         <a class="code" href="structsVpmg.html">Vpmg</a> *pmg[NOSH_MAXCALC]  
00229                                         );
00230 
00239 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a13">killMG</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVpbe.html">Vpbe</a> *pbe[NOSH_MAXCALC],
00240   <a class="code" href="structsVpmgp.html">Vpmgp</a> *pmgp[NOSH_MAXCALC], <a class="code" href="structsVpmg.html">Vpmg</a> *pmg[NOSH_MAXCALC]);
00241 
00250 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a14">solveMG</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsVpmg.html">Vpmg</a> *pmg, <a class="code" href="group__MGparm.html#a0">MGparm_CalcType</a> type);
00251 
00260 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a15">setPartMG</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsMGparm.html">MGparm</a> *mgparm, <a class="code" href="structsVpmg.html">Vpmg</a> *pmg);
00261 
00275 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a16">energyMG</a>(<a class="code" href="structsNOsh.html">NOsh</a>* nosh, <span class="keywordtype">int</span> icalc, <a class="code" href="structsVpmg.html">Vpmg</a> *pmg,
00276   <span class="keywordtype">int</span> *nenergy, <span class="keywordtype">double</span> *totEnergy, <span class="keywordtype">double</span> *qfEnergy, <span class="keywordtype">double</span> *qmEnergy,
00277   <span class="keywordtype">double</span> *dielEnergy);
00278 
00283 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a17">killEnergy</a>();
00284 
00298 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a18">forceMG</a>(Vmem *mem, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm,  <a class="code" href="structsMGparm.html">MGparm</a> *mgparm,
00299   <a class="code" href="structsVpmg.html">Vpmg</a> *pmg, <span class="keywordtype">int</span> *nforce, AtomForce **atomForce, <a class="code" href="structsValist.html">Valist</a> *alist[NOSH_MAXMOL]);
00300 
00309 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a19">killForce</a>(Vmem *mem, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <span class="keywordtype">int</span> nforce[NOSH_MAXCALC],
00310   AtomForce *atomForce[NOSH_MAXCALC]);
00311 
00316 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a20">storeAtomEnergy</a>(
00317                 <a class="code" href="structsVpmg.html">Vpmg</a> *pmg, 
00318                 <span class="keywordtype">int</span> icalc, 
00319                 <span class="keywordtype">double</span> **atomEnergy, 
00320                 <span class="keywordtype">int</span> *nenergy 
00321                 );
00322 
00339 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a21">writedataFlat</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, Vcom *com, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname, 
00340   <span class="keywordtype">double</span> totEnergy[NOSH_MAXCALC], <span class="keywordtype">double</span> qfEnergy[NOSH_MAXCALC], 
00341   <span class="keywordtype">double</span> qmEnergy[NOSH_MAXCALC], <span class="keywordtype">double</span> dielEnergy[NOSH_MAXCALC],
00342   <span class="keywordtype">int</span> nenergy[NOSH_MAXCALC], <span class="keywordtype">double</span> *atomEnergy[NOSH_MAXCALC],
00343   <span class="keywordtype">int</span> nforce[NOSH_MAXCALC], AtomForce *atomForce[NOSH_MAXCALC]);
00344 
00361 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a22">writedataXML</a>(<a class="code" href="structsNOsh.html">NOsh</a> *nosh, Vcom *com, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname, 
00362   <span class="keywordtype">double</span> totEnergy[NOSH_MAXCALC], <span class="keywordtype">double</span> qfEnergy[NOSH_MAXCALC], 
00363   <span class="keywordtype">double</span> qmEnergy[NOSH_MAXCALC], <span class="keywordtype">double</span> dielEnergy[NOSH_MAXCALC],
00364   <span class="keywordtype">int</span> nenergy[NOSH_MAXCALC], <span class="keywordtype">double</span> *atomEnergy[NOSH_MAXCALC],
00365   <span class="keywordtype">int</span> nforce[NOSH_MAXCALC], AtomForce *atomForce[NOSH_MAXCALC]);
00366 
00376 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a23">writedataMG</a>(<span class="keywordtype">int</span> rank, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm, <a class="code" href="structsVpmg.html">Vpmg</a> *pmg);
00377 
00387 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a24">writematMG</a>(<span class="keywordtype">int</span> rank, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm, <a class="code" href="structsVpmg.html">Vpmg</a> *pmg);
00388 
00398 <span class="keywordtype">double</span> <a class="code" href="group__Frontend.html#a25">returnEnergy</a>(Vcom *com, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <span class="keywordtype">double</span> totEnergy[NOSH_MAXCALC], <span class="keywordtype">int</span> iprint);
00399 
00405 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a26">printEnergy</a>(
00406                                                  Vcom *com, 
00407                                                  <a class="code" href="structsNOsh.html">NOsh</a> *nosh, 
00408                                                  <span class="keywordtype">double</span> totEnergy[NOSH_MAXCALC], 
00410                                                  <span class="keywordtype">int</span> iprint 
00411                                                  );
00412 
00418 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a27">printElecEnergy</a>(
00419                                                  Vcom *com, 
00420                                                  <a class="code" href="structsNOsh.html">NOsh</a> *nosh, 
00421                                                  <span class="keywordtype">double</span> totEnergy[NOSH_MAXCALC], 
00423                                                  <span class="keywordtype">int</span> iprint 
00424                                                  );
00425 
00431 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a28">printApolEnergy</a>(
00432                                                  <a class="code" href="structsNOsh.html">NOsh</a> *nosh,  
00433                                                  <span class="keywordtype">int</span> iprint  
00434                                                  );
00435 
00441 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a29">printForce</a>(
00442                                                 Vcom *com, 
00443                                                 <a class="code" href="structsNOsh.html">NOsh</a> *nosh, 
00444                                                 <span class="keywordtype">int</span> nforce[NOSH_MAXCALC], 
00445                                                 AtomForce *atomForce[NOSH_MAXCALC], 
00446                                                 <span class="keywordtype">int</span> i 
00447                                                 );
00448 
00454 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a30">printElecForce</a>(
00455                                                         Vcom *com, 
00456                                                         <a class="code" href="structsNOsh.html">NOsh</a> *nosh, 
00457                                                         <span class="keywordtype">int</span> nforce[NOSH_MAXCALC], 
00458                                                         AtomForce *atomForce[NOSH_MAXCALC], 
00459                                                         <span class="keywordtype">int</span> i 
00460                                                         );
00461 
00467 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a31">printApolForce</a>(
00468                                                         Vcom *com, 
00469                                                         <a class="code" href="structsNOsh.html">NOsh</a> *nosh, 
00470                                                         <span class="keywordtype">int</span> nforce[NOSH_MAXCALC], 
00471                                                         AtomForce *atomForce[NOSH_MAXCALC], 
00472                                                         <span class="keywordtype">int</span> i 
00473                                                         );
00474 
00479 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a32">startVio</a>();
00480 
00481 <span class="preprocessor">#ifdef HAVE_MC_H</span>
00482 <span class="preprocessor"></span>
00490 <span class="keywordtype">void</span> <a class="code" href="group__Frontend.html#a33">printFEPARM</a>(<span class="keywordtype">int</span> icalc, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsFEMparm.html">FEMparm</a> *feparm,
00491   <a class="code" href="structsVfetk.html">Vfetk</a> *fetk[NOSH_MAXCALC]);
00492 
00507 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a34">energyFE</a>(<a class="code" href="structsNOsh.html">NOsh</a>* nosh, <span class="keywordtype">int</span> icalc, <a class="code" href="structsVfetk.html">Vfetk</a> *fetk[NOSH_MAXCALC],
00508   <span class="keywordtype">int</span> *nenergy, <span class="keywordtype">double</span> *totEnergy, <span class="keywordtype">double</span> *qfEnergy, <span class="keywordtype">double</span> *qmEnergy,
00509   <span class="keywordtype">double</span> *dielEnergy);
00510 
00525 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a35">initFE</a>(<span class="keywordtype">int</span> icalc, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsFEMparm.html">FEMparm</a> *feparm, <a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm,
00526   <a class="code" href="structsVpbe.html">Vpbe</a> *pbe[NOSH_MAXCALC], <a class="code" href="structsValist.html">Valist</a> *alist[NOSH_MAXMOL], 
00527   <a class="code" href="structsVfetk.html">Vfetk</a> *fetk[NOSH_MAXCALC]);
00528 
00538 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a36">preRefineFE</a>(<span class="keywordtype">int</span> i, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsFEMparm.html">FEMparm</a> *feparm,
00539   <a class="code" href="structsVfetk.html">Vfetk</a> *fetk[NOSH_MAXCALC]);
00540 
00550 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a37">partFE</a>(<span class="keywordtype">int</span> i, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsFEMparm.html">FEMparm</a> *feparm,
00551   <a class="code" href="structsVfetk.html">Vfetk</a> *fetk[NOSH_MAXCALC]);
00552 
00563 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a38">solveFE</a>(<span class="keywordtype">int</span> i, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm, <a class="code" href="structsFEMparm.html">FEMparm</a> *feparm,
00564   <a class="code" href="structsVfetk.html">Vfetk</a> *fetk[NOSH_MAXCALC]);
00565 
00578 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a39">postRefineFE</a>(<span class="keywordtype">int</span> icalc, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsFEMparm.html">FEMparm</a> *feparm,
00579   <a class="code" href="structsVfetk.html">Vfetk</a> *fetk[NOSH_MAXCALC]);
00580 
00590 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a40">writedataFE</a>(<span class="keywordtype">int</span> rank, <a class="code" href="structsNOsh.html">NOsh</a> *nosh, <a class="code" href="structsPBEparm.html">PBEparm</a> *pbeparm, <a class="code" href="structsVfetk.html">Vfetk</a> *fetk);
00591 
00597 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a41">energyAPOL</a>(
00598                                                 <a class="code" href="structsAPOLparm.html">APOLparm</a> *apolparm, 
00599                                                 <span class="keywordtype">double</span> sasa, 
00600                                                 <span class="keywordtype">double</span> sav 
00601                                                 );
00602 
00608 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a42">forceAPOL</a>(
00609                                            <a class="code" href="structsVacc.html">Vacc</a> *acc,  
00610                                            Vmem *mem,  
00611                                            <a class="code" href="structsAPOLparm.html">APOLparm</a> *apolparm,  
00613                                            <span class="keywordtype">int</span> *nforce,  
00615                                            AtomForce **atomForce,  
00617                                            <a class="code" href="structsValist.html">Valist</a> *alist,  
00618                                            <a class="code" href="structsVclist.html">Vclist</a> *clist  
00619                                            );
00620 
00626 <span class="keywordtype">int</span> <a class="code" href="group__Frontend.html#a43">initAPOL</a>(
00627                                           <a class="code" href="structsNOsh.html">NOsh</a> *nosh,  
00628                                           Vmem *mem,  
00629                                           <a class="code" href="structVparam.html">Vparam</a> *param,  
00630                                           <a class="code" href="structsAPOLparm.html">APOLparm</a> *apolparm,  
00631                                           <span class="keywordtype">int</span> *nforce,  
00632                                           AtomForce **atomForce,  
00633                                           <a class="code" href="structsValist.html">Valist</a> *alist  
00634                                           );
00635 
00636 <span class="preprocessor">#endif</span>
00637 <span class="preprocessor"></span>
00638 <span class="preprocessor">#endif</span>
00639 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 25 11:58:14 2007 for APBS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
